##f$Gecko_notes##
//*****************************************************************************
//
// OpenPPL default bot
//   This bot-logic will be executed on undefined situations
//
// OpenPPL is part of the OpenHoldem project
//   Source code:           http://code.google.com/p/openholdembot/
//   Download page:         https://sites.google.com/site/openholdempokerbot/downloads
//   Forums:                http://www.maxinmontreal.com/forums/index.php
//   Licensed under GPL v3: http://www.gnu.org/licenses/gpl.html
//
// The original PPL (Poker Programming Language) got invented by
//   Shanky Bonusbots:      http://bonusbots.com/support/index.php
//
// Required OpenHoldem version: 12.0.0 or later
//
// Main author: Gecko 
//
// Co-author:   ThehighFish
//   (adaptions for OpenHoldem 12.x, documentation, simplification,          
//    extending preflop to full-ring)
//
//*****************************************************************************
//
// For the technical and logical changes please refer to the file
//   Gecko_changelog.txt
//
//*****************************************************************************

##Gecko_6Max_FR_NL_BSS_Preflop##
WHEN isomaha Fold FORCE
WHEN f$preflop_raise Return f$BestBetsize FORCE
WHEN f$call_nuts Call FORCE
WHEN f$call_minbets Call FORCE
// No WHEN f$call_potcommitted Call FORCE here.
// AA and KK get handled by f$call_nuts.
// With weaker hands we are already allin (small stack)
// or have enough chips left that we are not committed
WHEN f$preflop_call Call FORCE

##Gecko_6Max_FR_NL_BSS_Flop##
WHEN isomaha Fold FORCE
WHEN f$flop_raise Return f$BestBetsize FORCE
WHEN f$flop_turn_raise_strong_set Return f$BestBetsize FORCE
WHEN f$call_nuts Call FORCE
WHEN f$call_minbets Call FORCE
WHEN f$call_potcommitted Call FORCE 
WHEN f$flop_call Call FORCE

##Gecko_6Max_FR_NL_BSS_Turn##
WHEN isomaha Fold FORCE
WHEN f$turn_raise Return f$BestBetsize FORCE
WHEN f$flop_turn_raise_strong_set Return f$BestBetsize FORCE
WHEN f$call_nuts Call FORCE
WHEN f$call_minbets Call FORCE
WHEN f$call_potcommitted Call FORCE
WHEN f$turn_call Call FORCE

##Gecko_6Max_FR_NL_BSS_River##
WHEN isomaha Fold FORCE
WHEN f$river_raise Return f$BestBetsize FORCE
// No longer going automatically broke with strong sets
WHEN f$call_nuts Call FORCE
WHEN f$call_minbets Call FORCE
WHEN f$call_potcommitted Call FORCE
WHEN f$river_call Call FORCE

##f$positional_allin_on_betsize_balance_ratio##
// As a small improvement we decided that we should
// go more liberally allin out of position
// to reduce the disadvantage of position and put more 
// pressure on the opponent.
// http://www.maxinmontreal.com/forums/viewtopic.php?f=297&t=21070&p=147907#p147907
WHEN (Position = Last) RETURN 0.50 FORCE
WHEN Others RETURN 0.40 FORCE

##f$allin_on_betsize_balance_ratio##
// Not present in Geckos original bot for OpenHoldem 2.x,
// His code suggests that he wanted it to be 0.66,
// but as Gecko used raise-by-semantics and we use raise-to
// about 0.50 looks like a more appropriate value,
// firther improving it to 40% OOP,
// Fail-safe for mis-scraped stacks
WHEN (StackSize <= 0) RETURN 0.00 FORCE
WHEN NOT HandIsHeadsup RETURN f$positional_allin_on_betsize_balance_ratio FORCE
// Sole opponent already allin or mis-scraped opponents stack
WHEN (StackSize_headsupchair <= 0) RETURN f$positional_allin_on_betsize_balance_ratio FORCE
// Opponents stack larger than ours: normal behaviour
WHEN (StackSize_headsupchair >= StackSize) RETURN f$positional_allin_on_betsize_balance_ratio FORCE
// Single opponent with smaller stack.
// Go more lightly allin if our bet is more than 50% of his stack.
WHEN Others RETURN (f$positional_allin_on_betsize_balance_ratio * (StackSize_headsupchair / StackSize)) FORCE

##f$call_nuts##
// Basic calls with nuts or free to check
WHEN HaveNuts RETURN true FORCE
WHEN [prwin >= 0.98] RETURN true FORCE
WHEN [call <= 0.001] RETURN true FORCE
WHEN [IsPreflop AND (hand$AA OR hand$KK)] RETURN true FORCE

##f$call_minbets##
WHEN IsPreflop RETURN false FORCE
WHEN [call<=bblind AND nbetsround_preflop>1 AND (f$prwin > 0.15)] RETURN true FORCE 
WHEN [call<=bblind AND (EffectivePotSize > 6) AND (f$prwin > 0.50)] RETURN true FORCE

##f$call_potcommitted##
[ IsPreflop ] ? false :
[ AmountToCall*10 < EffectivePotSize ] ? f$prwin>.30 :
[ AmountToCall*9  < EffectivePotSize ] ? f$prwin>.40 :
[ AmountToCall*8  < EffectivePotSize ] ? f$prwin>.50 :
[ AmountToCall*7  < EffectivePotSize ] ? f$prwin>.60 :
[ AmountToCall*6  < EffectivePotSize ] ? f$prwin>.75 :
[ AmountToCall*5  < EffectivePotSize ] ? f$prwin>.80 :
[ AmountToCall*4  < EffectivePotSize ] ? f$prwin>.85 :
[ AmountToCall*3  < EffectivePotSize ] ? f$prwin>.95 :
[ nplayersplaying==2 ] ? {
    [ f$prwin>0.65 AND f$prwin<=0.70 ] ? (balance*7<EffectivePotSizeInDollars) :
    [ f$prwin>0.70 AND f$prwin<=0.75 ] ? (balance*6<EffectivePotSizeInDollars) :
    [ f$prwin>0.75 AND f$prwin<=0.80 ] ? (balance*5<EffectivePotSizeInDollars) :
    [ f$prwin>0.80 AND f$prwin<=0.85 ] ? (balance*4<EffectivePotSizeInDollars) :
    [ f$prwin>0.85 AND f$prwin<=0.90 ] ? (balance*3<EffectivePotSizeInDollars) :
    [ f$prwin>0.90                  ] ? (balance*3<EffectivePotSizeInDollars) :
    [ (f$villain_allin OR f$villain_potcommitted) ] ? {
        [ f$prwin>0.68 AND f$prwin<=0.72 ] ? (AmountToCall*7.0 < EffectivePotSize) :
        [ f$prwin>0.72 AND f$prwin<=0.76 ] ? (AmountToCall*6.0 < EffectivePotSize) :
        [ f$prwin>0.76 AND f$prwin<=0.80 ] ? (AmountToCall*4.0 < EffectivePotSize) :
        [ f$prwin>0.80 AND f$prwin<=0.82 ] ? (AmountToCall*3.5 < EffectivePotSize) :
        [ f$prwin>0.82 AND f$prwin<=0.86 ] ? (AmountToCall*3.0 < EffectivePotSize) :
        [ f$prwin>0.86 AND f$prwin<=0.90 ] ? (AmountToCall*2.5 < EffectivePotSize) : 
        [ f$prwin>0.90 AND f$prwin<=0.96 ] ? (AmountToCall*2.0 < EffectivePotSize) : 
        [ f$prwin>0.96                   ] ? (AmountToCall*1.0 < EffectivePotSize) : 0 } : 0 } :
0 

##f$flop_turn_raise_strong_set##
[ IsPostflop AND NOT IsRiver AND HaveSet AND nsuitedcommon<4 AND nstraightcommon<4 AND NOT PairOnBoard ] 

##f$prwin_number_of_iterations##
50000

##Gecko_6Max_FR_NL_BSS_Prwin_number_of_opponents##
// Values will be rounded down, but we prefer to distinguish these cases
nplayersplaying==2 AND nplayersround_flop<=2 ? 1.00 :
nplayersplaying==2 AND nplayersround_flop==3 ? 1.50 :
nplayersplaying==2 AND nplayersround_flop==4 ? 2.25 :
nplayersplaying==2 AND nplayersround_flop==5 ? 2.50 :
nplayersplaying==2 AND nplayersround_flop>=6 ? 2.25 :
nplayersplaying==3 AND nplayersround_flop<=3 ? 1.33 :
nplayersplaying==3 AND nplayersround_flop==4 ? 2.00 :
nplayersplaying==3 AND nplayersround_flop==5 ? 2.66 :
nplayersplaying==3 AND nplayersround_flop>=6 ? 3.00 :
nplayersplaying==4 AND nplayersround_flop<=4 ? 2.50 :
nplayersplaying==4 AND nplayersround_flop==5 ? 2.75 :
nplayersplaying==4 AND nplayersround_flop>=6 ? 3.00 :
nplayersplaying==5 AND nplayersround_flop<=5 ? 3.25 :
nplayersplaying==5 AND nplayersround_flop>=6 ? 3.33 :
nplayersplaying==6 AND nplayersround_flop<=6 ? 3.50 : 
// Extension for more than 6 players
nplayersplaying==6 AND nplayersround_flop>=6 ? 4.00 : 
nplayersplaying>=7 AND nplayersround_flop>=7 ? 4.50 : 
// Geckos default
1

##f$delay##
// Rendom delay of 0..3000 milli-seconds
Random * 30

##Gecko_6Max_FR_NL_BSS_Prefold##
// A little bit of randomization for flesh-and-blood-players
WHEN (Random < 10) RETURN false FORCE
When PairInHand Return false FORCE
// Prefold, depending on position
WHEN IsPostflop    RETURN false FORCE
WHEN (call < 0.01) RETURN false FORCE
WHEN (InBigBlind        AND NOT listGecko07)  RETURN true FORCE
WHEN (InSmallBlind      AND NOT listGecko900) RETURN true FORCE
WHEN (InButton          AND NOT listGecko900) RETURN true FORCE               
WHEN (InCutOff          AND NOT listGecko05)  RETURN true FORCE
WHEN (InMiddlePosition3 AND NOT listGecko02)  RETURN true FORCE
WHEN (InMiddlePosition2 AND NOT listGecko01)  RETURN true FORCE
// Extended to full-ring
// Simply assuming we can fold in early position as much as in MP2
WHEN (Others            AND NOT listGecko01)  RETURN true FORCE

##f$preflop_raise##
   f$Preflop_First_In
OR f$Preflop_Raise_After_One_Limper
OR f$Preflop_Raise_After_Two_Limpers
OR f$Preflop_Raise_After_Three_Limpers
OR f$Preflop_Raise_Monster
OR f$Preflop_Raiser_In_Front_Of_Me
OR f$Preflop_Raiser_And_Callers_In_Front_Of_Me
OR f$Preflop_Multiple_Raisers
OR f$Preflop_React_To_Reraise

##f$pt_pfr##
WHEN NOT HandIsHeadsup RETURN 0 FORCE
WHEN pt_hands_headsupchair < f$pt_min_hands_for_opponent_modelling RETURN 0 FORCE
WHEN Others RETURN pt_pfr_headsupchair FORCE

##f$pt_vpip##
WHEN NOT HandIsHeadsup RETURN 0 FORCE
WHEN pt_hands_headsupchair < f$pt_min_hands_for_opponent_modelling RETURN 0 FORCE
WHEN Others RETURN pt_vpip_headsupchair FORCE

##f$pt_flopaf##
WHEN NOT HandIsHeadsup RETURN 0 FORCE
WHEN pt_hands_headsupchair < f$pt_min_hands_for_opponent_modelling RETURN 0 FORCE
WHEN Others RETURN pt_flop_af_headsupchair FORCE

##f$pt_turnaf##
WHEN NOT HandIsHeadsup RETURN 0 FORCE
WHEN pt_hands_headsupchair < f$pt_min_hands_for_opponent_modelling RETURN 0 FORCE
WHEN Others RETURN pt_turn_af_headsupchair FORCE

##f$pt_riveraf##
WHEN NOT HandIsHeadsup RETURN 0 FORCE
WHEN pt_hands_headsupchair < f$pt_min_hands_for_opponent_modelling RETURN 0 FORCE
WHEN Others RETURN pt_river_af_headsupchair FORCE

##f$pt_fbbts##
//WHEN pt_hands_headsupchair < f$pt_min_hands_for_opponent_modelling RETURN 0 FORCE
pt_bb_fold_to_steal_headsupchair

##f$pt_fsbts##
// WHEN pt_hands_headsupchair < f$pt_min_hands_for_opponent_modelling RETURN 0 FORCE
pt_sb_fold_to_steal_headsupchair

##f$pt_wtsd##
WHEN pt_hands_headsupchair >= f$pt_min_hands_for_opponent_modelling RETURN pt_wtsd_headsupchair FORCE
When Others Return 0.35 Force

##f$pt_hands##
pt_hands_headsupchair

##f$PT_Flop_AF_RaisChair##
// !!! name it "adjusted" !!!
// WHEN pt_hands_raischair < f$pt_min_hands_for_opponent_modelling RETURN 0 FORCE
(pt_flop_af_raischair*(pt_wtsd_raischair*4))

##f$PT_Turn_AF_RaisChair##
// WHEN pt_hands_raischair < f$pt_min_hands_for_opponent_modelling RETURN 0 FORCE
(pt_turn_af_raischair*(pt_wtsd_raischair*4))

##f$PT_River_AF_RaisChair##
// WHEN pt_hands_raischair < f$pt_min_hands_for_opponent_modelling RETURN 0 FORCE
(pt_river_af_raischair*(pt_wtsd_raischair*4))

##f$pt_min_hands_for_opponent_modelling##
WHEN IsPreflop RETURN  50 FORCE
WHEN Others    RETURN 150 FORCE

##f$draws##
   (NOT TwoPairOnBoard AND HaveFlushDraw AND nsuitedcommon==2 AND nstraight==4 AND NOT StraightPossible AND NOT f$wheeldraw AND NOT PairOnBoard) 
OR (NOT TwoPairOnBoard AND HaveFlushDraw AND FlushPossible AND nstraight==4 AND NOT f$wheeldraw AND (NumberOfUnknownSuitedOvercards<=3) AND NOT StraightPossible AND NOT PairOnBoard) 
OR (IsFlop AND NOT TwoPairOnBoard AND HaveFlushDraw AND nsuitedcommon==2 AND nstraight==4 AND NOT f$wheeldraw AND NOT StraightPossible AND PairOnBoard) 
OR (IsFlop AND NOT TwoPairOnBoard AND HaveFlushDraw AND FlushPossible AND nstraight==4 AND NOT f$wheeldraw AND (NumberOfUnknownSuitedOvercards<=3) AND NOT StraightPossible AND PairOnBoard) ? 4 :

   ((NOT TwoPairOnBoard AND HaveNutFlushDraw AND nsuitedcommon==2 AND NOT PairOnBoard) 
OR (NOT TwoPairOnBoard AND rankloplayer>rankhicommon AND NOT StraightPossible AND NOT PairOnBoard AND HaveFlushDraw AND nsuitedcommon==2) 
OR (NOT TwoPairOnBoard AND hand$AA AND FlushPossible AND HaveFlushDraw AND NOT PairOnBoard) 
OR (NOT TwoPairOnBoard AND nstraight==4 AND nstraight>nstraightcommon AND NOT f$wheeldraw AND ishipair AND NOT FlushPossible AND NOT PairOnBoard AND (pokervalcommon < onepair)) 
OR (HaveFlushDraw AND nsuited>nsuitedcommon AND ishipair AND NOT PairOnBoard)) ? 3 :

   ((NOT TwoPairOnBoard AND HaveNutFlushDraw AND FlushPossible AND NOT PairOnBoard) 
OR (NOT TwoPairOnBoard AND HaveNutFlushDraw AND FlushPossible AND nrankedcommon<3) 
OR (NOT TwoPairOnBoard AND nstraight==4 AND nstraight>nstraightcommon AND NOT f$wheeldraw AND ismidpair AND nrankedcommon<3 AND NOT FlushPossible AND (pokervalcommon < onepair)) 
OR (NOT TwoPairOnBoard AND HaveFlushDraw AND nsuited>nsuitedcommon AND ismidpair AND nrankedcommon<3 AND (pokervalcommon < onepair)) 
OR (NOT TwoPairOnBoard AND HaveSecondNutFlushDraw AND nrankedcommon<3) 
OR (NOT TwoPairOnBoard AND HaveNutFlushDraw AND nsuitedcommon==2 AND nrankedcommon<3) 
OR (NOT TwoPairOnBoard AND HaveNutFlushDraw AND nsuitedcommon==2 AND nrankedcommon<3) 
OR (NOT TwoPairOnBoard AND HaveThirdNutFlushDraw AND nrankedcommon<3) 
OR (NOT TwoPairOnBoard AND HaveFlushDraw AND nsuitedcommon==2 AND nrankedcommon<3) 
OR (isthreeofakind AND NOT IsRiver AND NOT PairOnBoard) 
OR (rankloplayer>rankhicommon AND NOT IsRiver AND f$safeboard AND isonepair AND NOT PairInHand) 
OR (rankloplayer>rankhicommon AND NOT IsRiver AND NOT FlushPossible AND NOT StraightPossible AND nstraightfillcommon>1 AND istwopair AND PairOnBoard) 
OR (nstraightfill==1 AND NOT IsRiver AND istwopair AND PairOnBoard AND NOT FlushPossible) 
OR (nstraightfill==1 AND NOT IsRiver AND rankloplayer>rankhicommon AND f$safeboard) 
OR (nstraightfill==1 AND NOT IsRiver AND HaveBackdoorFlushDraw AND IsFlop AND rankhiplayer>rankhicommon AND f$safeboard) 
OR (NOT TwoPairOnBoard AND NOT IsRiver AND HaveFlushDraw AND FlushPossible AND rankloplayer>11 AND nrankedcommon<3) 
OR (NOT TwoPairOnBoard AND NOT IsRiver AND HaveBackdoorFlushDraw AND nsuitedcommon==1 AND nstraight==3 AND nstraightcommon<=2 AND rankloplayer>rankhicommon AND NOT PairOnBoard AND IsFlop) OR
   (NOT TwoPairOnBoard AND IsFlop AND nstraight==4 AND nstraightcommon==3 AND NOT f$wheeldraw AND NOT FlushPossible AND nrankedcommon<3 AND rankhiplayer>rankhicommon) 
OR (NOT TwoPairOnBoard AND nstraight==4 AND nstraightcommon<=2 AND NOT FlushPossible AND nrankedcommon<3 AND NOT f$wheeldraw AND nrankedcommon<3) 
OR (NOT TwoPairOnBoard AND NOT IsRiver AND nstraight==4 AND nstraightcommon==3 AND NOT f$wheeldraw AND rankloplayer>ranklocommon AND rankhiplayer>rankhicommon AND nrankedcommon<3)) ? 2 :

   ((NOT TwoPairOnBoard AND (nstraight==2 AND nstraightfillcommon==1 AND NOT FlushPossible AND NOT PairOnBoard)OR(nstraight==3 AND nstraightfillcommon==1 AND NOT FlushPossible AND NOT PairOnBoard)) 
OR (nstraightfill==1 AND NOT FlushPossible) 
OR (istwopair AND NOT PairOnBoard) 
OR (isonepair AND NOT FlushPossible AND NOT StraightPossible AND NOT PairOnBoard) 
OR (NOT TwoPairOnBoard AND FlushPossible AND HaveFlushDraw AND (srankloplayer>6 OR srankhiplayer>6) AND NOT PairOnBoard) 
OR (NOT TwoPairOnBoard AND nstraight==4 AND nstraightcommon==3 AND NOT PairOnBoard) 
OR (NOT TwoPairOnBoard AND nstraight==3 AND nstraightcommon==2 AND StraightPossible AND NOT PairOnBoard) 
OR (f$wheeldraw AND NOT PairOnBoard)) ? 1 : 0

##f$wheeldraw##
// !!! Does not consider all wheels
(rankbits>>9==0b111100)                                 // AKQJ
OR (rankbits & 0b0000000000011110)==0b0000000000011110  // 432A

##f$safeboard##
[ NOT PairOnBoard AND NOT FlushPossible AND NOT StraightPossible ]

##f$flop_call##
WHEN f$Odds_and_Outs      RETURN true FORCE
WHEN f$Initiative_Hero    RETURN f$flop_call_initiative FORCE
WHEN f$Initiative_Villain RETURN f$flop_call_noinitiative FORCE
WHEN f$Initiative_Nobody  RETURN f$flop_call_noaction FORCE

##f$turn_call##
WHEN f$Odds_and_Outs        RETURN true FORCE
WHEN f$Initiative_Hero      RETURN f$turn_call_initiative FORCE
WHEN f$Initiative_Villain   RETURN f$turn_call_noinitiative FORCE
WHEN f$Initiative_Nobody    RETURN f$turn_call_noaction FORCE
WHEN f$Initiative_GotRaised RETURN f$turn_call_wegotraised FORCE

##f$river_call##
WHEN f$Initiative_Hero      RETURN f$river_call_initiative FORCE
WHEN f$Initiative_Villain   RETURN f$river_call_noinitiative FORCE
WHEN f$Initiative_Nobody    RETURN f$river_call_noaction FORCE
WHEN f$Initiative_GotRaised RETURN f$river_call_wegotraised FORCE

##f$flop_raise##
WHEN f$Initiative_Hero    RETURN f$flop_raise_initiative FORCE
WHEN f$Initiative_Villain RETURN f$flop_raise_noinitiative FORCE
WHEN f$Initiative_Nobody  RETURN f$flop_raise_noaction FORCE

##f$turn_raise##
WHEN f$Initiative_Hero      RETURN f$turn_raise_initiative FORCE
WHEN f$Initiative_Villain   RETURN f$turn_raise_noinitiative FORCE
WHEN f$Initiative_Nobody    RETURN f$turn_raise_noaction FORCE
WHEN f$Initiative_GotRaised RETURN f$turn_raise_wegotraised FORCE

##f$river_raise##
WHEN f$Initiative_Hero      RETURN f$river_raise_initiative FORCE
WHEN f$Initiative_Villain   RETURN f$river_raise_noinitiative FORCE
WHEN f$Initiative_Nobody    RETURN f$river_raise_noaction FORCE
WHEN f$Initiative_GotRaised RETURN f$river_raise_wegotraised FORCE

##f$Initiative_Hero##
// Can't have initiative preflop: either we did not yet act or somebody raised
WHEN IsPreflop RETURN false FORCE
WHEN didcallround_previousround RETURN false FORCE
WHEN didbetsizeround_previousround OR didraisround_previousround RETURN true FORCE

##f$Initiative_Nobody##
NOT f$Initiative_Hero AND NOT f$Initiative_Villain

##f$Initiative_Villain##
WHEN IsPreflop RETURN ncallbets > 1 FORCE 
WHEN IsFlop    RETURN (didcallround_previousround AND nbetsround_preflop > 1) FORCE
WHEN Others    RETURN (didcallround_previousround AND nbetsround_previousround > 0) FORCE

##f$Initiative_GotRaised##
didbetsizeround_previousround AND (lastraised_previousround != userchair)

##f$prwin##
[prwin+(prtie/2)]**(1+f$threat)

##f$flop_raise_initiative##
[ Position = First ] ? {
    [ f$actionpostflop_free_to_play ] ? {
        [ nplayersplaying<=2 ] ? 1 :
//          [ f$fold2cbet_high OR f$fold2cbet_normal ] ? {
//            [ f$stackopponent< 30*bblind ] ? {
//                [ KingPresentOnFlop OR AcePresentOnFlop ] ? f$prwin>0 :
//                [ f$prwin>0.65                         ] ? 1         : 0 } :
//            [ f$stackopponent>=30*bblind ] ? {
//                [ f$pt_flopaf<4  ] ? f$prwin>0.00 :
//                [ f$pt_flopaf>=4 ] ? f$prwin>0.00 AND f$prwin<.92 : 0 } : 0 } :
//          [ f$fold2cbet_low ] ? {
//              [ f$pt_flopaf<4  ] ? {
//                  [ KingPresentOnFlop OR AcePresentOnFlop ] ? f$prwin>0 :
//                  [ f$prwin>0.65                         ] ? 1         : 0 } :
//              [ f$pt_flopaf>=4 ] ? f$prwin>0.65 AND f$prwin<.92 : 0 } : 0 } :
        [ nplayersplaying==3 ] ? 1            :
        [ nplayersplaying>=4 ] ? f$prwin>0.45 : 0 } :
    [ f$actionpostflop_opponent_min_bets ] ? {
        [ nplayersplaying<=2 ] ? f$prwin>0.45 :
        [ nplayersplaying==3 ] ? f$prwin>0.68 :
        [ nplayersplaying>=4 ] ? f$prwin>0.70 : 0 } :
    [ f$actionpostflop_opponent_bets_medium ] ? f$prwin>0.75 :
    [ f$actionpostflop_opponent_bets_pot ] ? f$prwin>0.76 :
    [ f$actionpostflop_opponent_overbets ] ? f$prwin>0.77 :
    [ f$actionpostflop_opponent_min_reraises ] ? {
        [ f$ptype_raise_contibet_very_low ] ? f$prwin2>.85 :
        [ f$ptype_raise_contibet_low     ] ? f$prwin2>.82 :
        [ f$ptype_raise_contibet_normal     ] ? f$prwin2>.78 :
        [ f$ptype_raise_contibet_high ] ? f$prwin2>.78 :
        [ f$ptype_raise_contibet_very_high     ] ? {
            [ nplayersplaying==2 ] ? f$prwin2>.72 : 
            [ nplayersplaying>=3 ] ? f$prwin2>.78 : 0 } : 0 } :
    [ f$actionpostflop_opponent_reraises_normal ] ? {
        [ f$ptype_raise_contibet_very_low ] ? f$prwin2>.85 :
        [ f$ptype_raise_contibet_low     ] ? f$prwin2>.82 :
        [ f$ptype_raise_contibet_normal     ] ? f$prwin2>.78 :
        [ f$ptype_raise_contibet_high ] ? f$prwin2>.78 :
        [ f$ptype_raise_contibet_very_high     ] ? {
            [ nplayersplaying==2 ] ? f$prwin2>.76 : 
            [ nplayersplaying>=3 ] ? f$prwin2>.78 : 0 } : 0 } :
    [ f$actionpostflop_opponent_reraises_huge ] ? {
        [ f$ptype_raise_contibet_very_low ] ? f$prwin2>.85 :
        [ f$ptype_raise_contibet_low     ] ? f$prwin2>.82 :
        [ f$ptype_raise_contibet_normal     ] ? f$prwin2>.78 :
        [ f$ptype_raise_contibet_high ] ? f$prwin2>.77 :
        [ f$ptype_raise_contibet_very_high     ] ? f$prwin2>.77 : 0 } :
    [ f$actionpostflop_medium_investment ] ? f$prwin>.85 :
    [ f$actionpostflop_large_investment] ? f$prwin>.85 : 0 } :
// ---------------------------------------------
[ Position = Middle ] ? {
    [ f$actionpostflop_free_to_play ] ? {
        [ nplayersplaying==2 ] ? 1 :
        [ nplayersplaying==3 ] ? {
            [ f$draws>1 AND HaveFlushDraw ] ? 1 :
            [ f$prwin>0.65            ] ? 1 : 0 } :
        [ nplayersplaying>=4 ] ? f$prwin>0.58 : 0 } :
    [ f$actionpostflop_opponent_min_bets ] ? {
        [ nplayersplaying==3 ] ? f$prwin>0.65 :
        [ nplayersplaying>=4 ] ? f$prwin>0.65 : 0 } :
    [ f$actionpostflop_opponent_bets_medium ] ? {
        [ nplayersplaying==2 ] ? f$prwin>.75 :
        [ nplayersplaying>=3 ] ? f$prwin>.78 : 0 } :
    [ f$actionpostflop_opponent_bets_pot ] ? f$prwin>.78 :
    [ f$actionpostflop_opponent_overbets ] ? f$prwin>.78 :
    [ f$actionpostflop_opponent_min_reraises ] ? {
        [ f$ptype_raise_contibet_very_low ] ? f$prwin2>.85 :
        [ f$ptype_raise_contibet_low     ] ? f$prwin2>.82 :
        [ f$ptype_raise_contibet_normal     ] ? f$prwin2>.78 :
        [ f$ptype_raise_contibet_high ] ? f$prwin2>.78 :
        [ f$ptype_raise_contibet_very_high     ] ? f$prwin2>.78 : 0 } :
    [ f$actionpostflop_opponent_reraises_normal ] ? {
        [ f$ptype_raise_contibet_very_low ] ? f$prwin2>.85 :
        [ f$ptype_raise_contibet_low     ] ? f$prwin2>.82 :
        [ f$ptype_raise_contibet_normal     ] ? f$prwin2>.78 :
        [ f$ptype_raise_contibet_high ] ? f$prwin2>.78 :
        [ f$ptype_raise_contibet_very_high     ] ? f$prwin2>.78 : 0 } :
    [ f$actionpostflop_opponent_reraises_huge ] ? {
        [ f$ptype_raise_contibet_very_low ] ? f$prwin2>.85 :
        [ f$ptype_raise_contibet_low     ] ? f$prwin2>.82 :
        [ f$ptype_raise_contibet_normal     ] ? f$prwin2>.80 :
        [ f$ptype_raise_contibet_high ] ? f$prwin2>.80 :
        [ f$ptype_raise_contibet_very_high     ] ? f$prwin2>.80 : 0 } :
    [ f$actionpostflop_medium_investment ] ? f$prwin>.85 :
    [ f$actionpostflop_large_investment] ? f$prwin>.85 : 0 } :
// ---------------------------------------------------
[ Position = Last ] ? {
    [ f$actionpostflop_free_to_play ] ? {
        [ nplayersplaying<=2 ] ? {
            [ f$prwin>0.00 AND f$prwin<0.38 ] ? 1 :
            [ f$prwin>0.40 AND f$prwin<0.45 ] ? 1 :
            [ f$prwin>0.50 AND f$prwin<0.55 ] ? 1 :
            [ f$prwin>0.60 AND f$prwin<0.82 ] ? 1 :
            [ f$prwin>0.86                 ] ? 1 : 0 } :
        [ nplayersplaying==3 ] ? 1            :
        [ nplayersplaying>=4 ] ? f$prwin>0.65 : 0 } :
    [ f$actionpostflop_opponent_min_bets ] ? {
        [ nplayersplaying<=2 ] ? f$prwin>0.30 :
        [ nplayersplaying==3 ] ? f$prwin>0.65 :
        [ nplayersplaying>=4 ] ? f$prwin>0.70 : 0 } :
    [ f$actionpostflop_opponent_bets_medium ] ? {
        [ nplayersplaying==2 ] ? {
            [ f$pt_wtsd<=0.00 ] ? f$prwin>.70 :
            [ f$pt_wtsd>0.00 AND f$pt_wtsd<=0.30 ] ? f$prwin>.65 AND f$prwin<.95 : // bluffraise his lead
            [ f$pt_wtsd>0.30 ] ? f$prwin>.70 : 0 } :
        [ nplayersplaying>=3 ] ? f$prwin>.78 : 0 } :
    [ f$actionpostflop_opponent_bets_pot ] ? f$prwin>.80 :
    [ f$actionpostflop_opponent_overbets ] ? f$prwin>.80 :
    [ f$actionpostflop_opponent_min_reraises ] ? {
        [ f$ptype_raise_contibet_very_low ] ? f$prwin2>.85 :
        [ f$ptype_raise_contibet_low     ] ? f$prwin2>.83 :
        [ f$ptype_raise_contibet_normal     ] ? f$prwin2>.79 :
        [ f$ptype_raise_contibet_high ] ? f$prwin2>.78 :
        [ f$ptype_raise_contibet_very_high     ] ? f$prwin2>.77 : 0 } :
    [ f$actionpostflop_opponent_reraises_normal ] ? {
        [ f$ptype_raise_contibet_very_low ] ? f$prwin2>.85 :
        [ f$ptype_raise_contibet_low     ] ? f$prwin2>.83 :
        [ f$ptype_raise_contibet_normal     ] ? f$prwin2>.79 :
        [ f$ptype_raise_contibet_high ] ? f$prwin2>.78 :
        [ f$ptype_raise_contibet_very_high     ] ? f$prwin2>.77 : 0 } :
    [ f$actionpostflop_opponent_reraises_huge ] ? {
        [ f$ptype_raise_contibet_very_low ] ? f$prwin2>.85 :
        [ f$ptype_raise_contibet_low     ] ? f$prwin2>.83 :
        [ f$ptype_raise_contibet_normal     ] ? f$prwin2>.80 :
        [ f$ptype_raise_contibet_high ] ? f$prwin2>.78:
        [ f$ptype_raise_contibet_very_high     ] ? f$prwin2>.78 : 0 } :
    [ f$actionpostflop_medium_investment ] ? f$prwin>.85 :
    [ f$actionpostflop_large_investment] ? f$prwin>.85 : 0 } :
0

##f$flop_raise_noinitiative##
[ Position = First ] ? {
    [ f$actionpostflop_free_to_play AND nplayersplaying==2 ] ? { // donk flop
        [ f$draws>=2                   ] ? 1 :
        [ f$prwin>0.40 AND f$prwin<0.60 ] ? 1 : 0 } :
    [ f$actionpostflop_opponent_min_bets ] ? f$prwin>.50 : // raise minbet
    [ f$actionpostflop_opponent_bets_medium ] ? {
        [ nplayersplaying==2 ] ? {
            [ nplayersround_flop==2 ] ? f$prwin>0.70 :
            [ nplayersround_flop>=3 ] ? f$prwin>0.75 : 0 } :
        [ nplayersplaying>=3 ] ? {
            [ nplayersround_flop==3 ] ? f$prwin>0.75 :
            [ nplayersround_flop>=4 ] ? f$prwin>0.80 : 0 } : 0 } :
    [ f$actionpostflop_opponent_bets_pot ] ? {
        [ f$draws>1 AND nplayersplaying==2 ] ? 1 :
        [ f$prwin>0.75 AND f$prwin<0.95    ] ? 1 : 0 } :
    [ f$actionpostflop_opponent_overbets ] ? f$prwin>.80 :
    [ f$actionpostflop_opponent_min_reraises ] ? {
        [ f$ptype_raise_contibet_very_low ] ? f$prwin2>.85 :
        [ f$ptype_raise_contibet_low     ] ? f$prwin2>.85 :
        [ f$ptype_raise_contibet_normal     ] ? f$prwin2>.85 :
        [ f$ptype_raise_contibet_high ] ? f$prwin2>.82 :
        [ f$ptype_raise_contibet_very_high     ] ? {
            [ nplayersplaying==2 ] ? f$prwin2>.80 : 
            [ nplayersplaying>=3 ] ? f$prwin2>.77 : 0 } : 0 } :
    [ f$actionpostflop_opponent_reraises_normal ] ? {
        [ f$ptype_raise_contibet_very_low ] ? f$prwin2>.85 :
        [ f$ptype_raise_contibet_low     ] ? f$prwin2>.85 :
        [ f$ptype_raise_contibet_normal     ] ? f$prwin2>.82 :
        [ f$ptype_raise_contibet_high ] ? f$prwin2>.80 :
        [ f$ptype_raise_contibet_very_high     ] ? {
            [ nplayersplaying==2 ] ? f$prwin2>.78 : 
            [ nplayersplaying>=3 ] ? f$prwin2>.77 : 0 } : 0 } :
    [ f$actionpostflop_opponent_reraises_huge ] ? {
        [ f$ptype_raise_contibet_very_low ] ? f$prwin2>.85 :
        [ f$ptype_raise_contibet_low     ] ? f$prwin2>.85 :
        [ f$ptype_raise_contibet_normal     ] ? f$prwin2>.82 :
        [ f$ptype_raise_contibet_high ] ? f$prwin2>.80 :
        [ f$ptype_raise_contibet_very_high     ] ? {
            [ nplayersplaying==2 ] ? f$prwin2>.78 : 
            [ nplayersplaying>=3 ] ? f$prwin2>.77 : 0 } : 0 } :
    [ f$actionpostflop_medium_investment ] ? f$prwin>.80 :
    [ f$actionpostflop_large_investment] ? f$prwin>.80 : 0 } :
[ Position = Middle ] ? {
    [ f$actionpostflop_free_to_play ] ? f$prwin>.72 :
    [ f$actionpostflop_opponent_min_bets ] ? f$prwin>.76 :
    [ f$actionpostflop_opponent_bets_medium ] ? f$prwin>.78 :
    [ f$actionpostflop_opponent_bets_pot ] ? f$prwin>.80 :
    [ f$actionpostflop_opponent_overbets ] ? f$prwin>.80 :
    [ f$actionpostflop_opponent_min_reraises ] ? {
        [ f$ptype_raise_contibet_very_low ] ? f$prwin2>.85 :
        [ f$ptype_raise_contibet_low     ] ? f$prwin2>.85 :
        [ f$ptype_raise_contibet_normal     ] ? f$prwin2>.82 :
        [ f$ptype_raise_contibet_high ] ? f$prwin2>.80 :
        [ f$ptype_raise_contibet_very_high     ] ? f$prwin2>.78 : 0 } :
    [ f$actionpostflop_opponent_reraises_normal ] ? {
        [ f$ptype_raise_contibet_very_low ] ? f$prwin2>.85 :
        [ f$ptype_raise_contibet_low     ] ? f$prwin2>.85 :
        [ f$ptype_raise_contibet_normal     ] ? f$prwin2>.82 :
        [ f$ptype_raise_contibet_high ] ? f$prwin2>.80 :
        [ f$ptype_raise_contibet_very_high     ] ? f$prwin2>.78 : 0 } :
    [ f$actionpostflop_opponent_reraises_huge ] ? {
        [ f$ptype_raise_contibet_very_low ] ? f$prwin2>.85 :
        [ f$ptype_raise_contibet_low     ] ? f$prwin2>.85 :
        [ f$ptype_raise_contibet_normal     ] ? f$prwin2>.82 :
        [ f$ptype_raise_contibet_high ] ? f$prwin2>.80 :
        [ f$ptype_raise_contibet_very_high     ] ? f$prwin2>.78 : 0 } :
    [ f$actionpostflop_medium_investment ] ? f$prwin>.80 :
    [ f$actionpostflop_large_investment] ? f$prwin>.80 : 0 } :
[ Position = Last ] ? {
    [ f$actionpostflop_free_to_play ] ? {
       [ nplayersplaying==2 ] ? {
           [ f$draws>1   ] ? 1 :
           [ f$prwin>.50 ] ? 1 : 0 } :
       [ nplayersplaying>=3 ] ? f$prwin>.60 : 0 } :
    [ f$actionpostflop_opponent_min_bets ] ? f$prwin>.67 :
    [ f$actionpostflop_opponent_bets_medium ] ? {
        [ f$draws>1                    ] ? 1 :
        [ f$prwin>0.72 AND f$prwin<0.90 ] ? 1 : 0 } :
    [ f$actionpostflop_opponent_bets_pot ] ? {
        [ f$draws>3                    ] ? 1 :
        [ f$prwin>0.75 AND f$prwin<0.90 ] ? 1 : 0 } :
    [ f$actionpostflop_opponent_overbets ] ? f$prwin>.80 :
    [ f$actionpostflop_opponent_min_reraises ] ? {
        [ f$ptype_raise_contibet_very_low ] ? f$prwin2>.85 :
        [ f$ptype_raise_contibet_low     ] ? f$prwin2>.85 :
        [ f$ptype_raise_contibet_normal     ] ? f$prwin2>.85 :
        [ f$ptype_raise_contibet_high ] ? f$prwin2>.82 :
        [ f$ptype_raise_contibet_very_high     ] ? f$prwin2>.80 : 0 } :
    [ f$actionpostflop_opponent_reraises_normal ] ? {
        [ f$ptype_raise_contibet_very_low ] ? f$prwin2>.85 :
        [ f$ptype_raise_contibet_low     ] ? f$prwin2>.85 :
        [ f$ptype_raise_contibet_normal     ] ? f$prwin2>.85 :
        [ f$ptype_raise_contibet_high ] ? f$prwin2>.82 :
        [ f$ptype_raise_contibet_very_high     ] ? f$prwin2>.80 : 0 } :
    [ f$actionpostflop_opponent_reraises_huge ] ? {
        [ f$ptype_raise_contibet_very_low ] ? f$prwin2>.85 :
        [ f$ptype_raise_contibet_low     ] ? f$prwin2>.85 :
        [ f$ptype_raise_contibet_normal     ] ? f$prwin2>.85 :
        [ f$ptype_raise_contibet_high ] ? f$prwin2>.83 :
        [ f$ptype_raise_contibet_very_high     ] ? f$prwin2>.82 : 0 } :
    [ f$actionpostflop_medium_investment ] ? f$prwin>.85 :
    [ f$actionpostflop_large_investment] ? f$prwin>.85 : 0 } :
0

##f$flop_raise_noaction##
[ Position = First ] ? {
    [ f$actionpostflop_free_to_play ] ? f$prwin>.55 :
    [ f$actionpostflop_opponent_min_bets ] ? f$prwin>.60 :
    [ f$actionpostflop_opponent_bets_medium ] ? f$prwin>.65 :
    [ f$actionpostflop_opponent_bets_pot ] ? f$prwin>.80 :
    [ f$actionpostflop_opponent_overbets ] ? f$prwin>.92 :
    [ f$actionpostflop_opponent_min_reraises ] ? {
        [ f$ptype_raise_contibet_very_low ] ? f$prwin2>.85 :
        [ f$ptype_raise_contibet_low     ] ? f$prwin2>.85 :
        [ f$ptype_raise_contibet_normal     ] ? f$prwin2>.85 :
        [ f$ptype_raise_contibet_high ] ? f$prwin2>.82 :
        [ f$ptype_raise_contibet_very_high     ] ? f$prwin2>.72 : 0 } :
    [ f$actionpostflop_opponent_reraises_normal ] ? {
        [ f$ptype_raise_contibet_very_low ] ? f$prwin2>.85 :
        [ f$ptype_raise_contibet_low     ] ? f$prwin2>.85 :
        [ f$ptype_raise_contibet_normal     ] ? f$prwin2>.85 :
        [ f$ptype_raise_contibet_high ] ? f$prwin2>.84 :
        [ f$ptype_raise_contibet_very_high     ] ? f$prwin2>.76 : 0 } :
    [ f$actionpostflop_opponent_reraises_huge ] ? {
        [ f$ptype_raise_contibet_very_low ] ? f$prwin2>.85 :
        [ f$ptype_raise_contibet_low     ] ? f$prwin2>.85 :
        [ f$ptype_raise_contibet_normal     ] ? f$prwin2>.85 :
        [ f$ptype_raise_contibet_high ] ? f$prwin2>.84 :
        [ f$ptype_raise_contibet_very_high     ] ? f$prwin2>.82 : 0 } :
    [ f$actionpostflop_medium_investment ] ? f$nuts      :
    [ f$actionpostflop_large_investment] ? f$nuts      : 0 } :
[ Position = Middle ] ? {
    [ f$actionpostflop_free_to_play ] ? f$prwin>.55 :
    [ f$actionpostflop_opponent_min_bets ] ? f$prwin>.60 :
    [ f$actionpostflop_opponent_bets_medium ] ? f$prwin>.65 :
    [ f$actionpostflop_opponent_bets_pot ] ? f$prwin>.80 :
    [ f$actionpostflop_opponent_overbets ] ? f$prwin>.92 :
    [ f$actionpostflop_opponent_min_reraises ] ? {
        [ f$ptype_raise_contibet_very_low ] ? f$prwin2>.85 :
        [ f$ptype_raise_contibet_low     ] ? f$prwin2>.85 :
        [ f$ptype_raise_contibet_normal     ] ? f$prwin2>.82 :
        [ f$ptype_raise_contibet_high ] ? f$prwin2>.80 :
        [ f$ptype_raise_contibet_very_high     ] ? {
            [ nplayersplaying==2 ] ? f$prwin2>.72 : 
            [ nplayersplaying>=3 ] ? f$prwin2>.80 : 0 } : 0 } :
    [ f$actionpostflop_opponent_reraises_normal ] ? {
        [ f$ptype_raise_contibet_very_low ] ? f$prwin2>.85 :
        [ f$ptype_raise_contibet_low     ] ? f$prwin2>.85 :
        [ f$ptype_raise_contibet_normal     ] ? f$prwin2>.84 :
        [ f$ptype_raise_contibet_high ] ? f$prwin2>.82 :
        [ f$ptype_raise_contibet_very_high     ] ? {
            [ nplayersplaying==2 ] ? f$prwin2>.76 : 
            [ nplayersplaying>=3 ] ? f$prwin2>.80 : 0 } : 0 } :
    [ f$actionpostflop_opponent_reraises_huge ] ? {
        [ f$ptype_raise_contibet_very_low ] ? f$prwin2>.85 :
        [ f$ptype_raise_contibet_low     ] ? f$prwin2>.85 :
        [ f$ptype_raise_contibet_normal     ] ? f$prwin2>.85 :
        [ f$ptype_raise_contibet_high ] ? f$prwin2>.84 :
        [ f$ptype_raise_contibet_very_high     ] ? f$prwin2>.82 : 0 } :
    [ f$actionpostflop_medium_investment ] ? f$nuts      :
    [ f$actionpostflop_large_investment] ? f$nuts      : 0 } :
[ Position = Last ] ? {
    [ f$actionpostflop_free_to_play ] ? f$prwin>.55 :
    [ f$actionpostflop_opponent_min_bets ] ? f$prwin>.60 :
    [ f$actionpostflop_opponent_bets_medium ] ? f$prwin>.65 :
    [ f$actionpostflop_opponent_bets_pot ] ? f$prwin>.80 :
    [ f$actionpostflop_opponent_overbets ] ? f$prwin>.92 :
    [ f$actionpostflop_opponent_min_reraises ] ? {
        [ f$ptype_raise_contibet_very_low ] ? f$prwin2>.85 :
        [ f$ptype_raise_contibet_low     ] ? f$prwin2>.85 :
        [ f$ptype_raise_contibet_normal     ] ? f$prwin2>.85 :
        [ f$ptype_raise_contibet_high ] ? f$prwin2>.82 :
        [ f$ptype_raise_contibet_very_high     ] ? f$prwin2>.80 : 0 } :

    [ f$actionpostflop_opponent_reraises_normal ] ? {
        [ f$ptype_raise_contibet_very_low ] ? f$prwin2>.85 :
        [ f$ptype_raise_contibet_low     ] ? f$prwin2>.85 :
        [ f$ptype_raise_contibet_normal     ] ? f$prwin2>.85 :
        [ f$ptype_raise_contibet_high ] ? f$prwin2>.84 :
        [ f$ptype_raise_contibet_very_high     ] ? f$prwin2>.82 : 0 } :
    [ f$actionpostflop_opponent_reraises_huge ] ? {
        [ f$ptype_raise_contibet_very_low ] ? f$prwin2>.85 :
        [ f$ptype_raise_contibet_low     ] ? f$prwin2>.85 :
        [ f$ptype_raise_contibet_normal     ] ? f$prwin2>.85 :
        [ f$ptype_raise_contibet_high ] ? f$prwin2>.84 :
        [ f$ptype_raise_contibet_very_high     ] ? f$prwin2>.82 : 0 } :
    [ f$actionpostflop_medium_investment ] ? f$nuts      :
    [ f$actionpostflop_large_investment] ? f$nuts      : 0 } :
0

##f$BestBetsize##
WHEN IsPreflop RETURN f$BetsizePreflop FORCE
WHEN HandIsHeadsup
   WHEN IsFlop  RETURN f$BetsizeFlopHeadsup  FORCE
   WHEN IsTurn  RETURN f$BetsizeTurnHeadsup  FORCE
   WHEN IsRiver RETURN f$BetsizeRiverHeadsup FORCE
WHEN Others
   WHEN IsFlop  RETURN f$BetsizeFlopMultiway  FORCE
   WHEN IsTurn  RETURN f$BetsizeTurnMultiway  FORCE
   WHEN IsRiver RETURN f$BetsizeRiverMultiway FORCE   

##f$BetsizePreflop##
WHEN (Raises > 0) RaiseBy (4 * BetSize) FORCE
WHEN (Calls > 0) RaiseTo (3.5 + (0.5 * nopponentscalling)) FORCE
// Openraising with flexible betsize, depending on position / range
// http://www.maxinmontreal.com/forums/viewtopic.php?f=297&t=21070&start=90#p148218
WHEN InLatePosition AND istournament AND (BigBlindSize > 100) RaiseTo 2.5 FORCE
WHEN InLatePosition RaiseTo 3 FORCE
WHEN InMiddlePosition RaiseTo 3.5 FORCE
WHEN InEarlyPosition RaiseTo 4 FORCE
WHEN InTheBlinds RaiseTo 3 FORCE
	
##f$BetsizeFlopHeadsup##
WHEN (AmountToCall <= 1)
   WHEN (nbetsround_preflop <= 6)  RaiseBy 75% FORCE
   WHEN Others  RaiseBy 55% FORCE
WHEN NOT didbetsize
   WHEN (AmountToCall <= 33% PotSize) RaisePot FORCE
   WHEN Others RaiseBy (2 * BetSize) FORCE
WHEN Others
   WHEN (nbetsround_preflop <= 1) RaiseBy (2 * BetSize) FORCE
   WHEN f$ptype_raise_contibet_very_high RaiseBy (2 * BetSize) FORCE
   // Formerly RaiseMax.
   WHEN Others RaisePot FORCE
           
##f$BetsizeTurnHeadsup##
WHEN (AmountToCall <= 0)
   WHEN (PotSize <= 35) RaiseBy 70% FORCE
   WHEN Others RaisePot FORCE
WHEN (AmountToCall <= 2)
   WHEN (PotSize <= 25) RaisePot FORCE
   WHEN Others RaiseBy 65% FORCE
WHEN Others
   // Formerly RaiseMax.
   WHEN f$betline RaisePot FORCE
   WHEN (AmountToCall <= 33% PotSize) RaisePot FORCE
   WHEN Others RaiseBy (4 * BetSize) FORCE

##f$BetsizeRiverHeadsup##
WHEN (AmountToCall <= 0)
   WHEN (PotSize <= 10) RaiseBy 80% FORCE
   WHEN (PotSize <= 80) RaiseBy 60% FORCE
   // Huge pot, don't blow money away.
   // Make betsize dependent on prwin.
   // Block-bet with not so strong hands
   WHEN (f$prwin<=0.8) RaiseBy 25% FORCE
   WHEN Others RaiseBy 60% FORCE   
WHEN (AmountToCall <= 2) RaisePot FORCE
WHEN Others
   WHEN (AmountToCall <= 33% PotSize) RaisePot FORCE
   WHEN Others RaiseBy (3 * BetSize) FORCE

##f$BetsizeFlopMultiway##
// Gecko had here 60% / 62%,
// which is pointless due to rounding
WHEN (AmountToCall <= 1) RaiseBy 60% FORCE
WHEN [ NOT didbetsize ] 
   WHEN (AmountToCall <= 33% PotSize) RaiseBy 80% FORCE
   WHEN Others RaiseBy (4 * BetSize) FORCE
WHEN Others
   WHEN (nbetsround_preflop<=1) RaiseBy (4 * BetSize) FORCE
   // Preflop raised, flop reraised.
   // Lots of action, large pot.
   // Formerly RaiseMax.
   WHEN Others RaisePot FORCE

##f$BetsizeTurnMultiway##
WHEN (AmountToCall <= 1)
   WHEN (PotSize <= 10) RaiseBy 70% FORCE
   WHEN Others RaiseBy 60% FORCE
WHEN Others
   WHEN (AmountToCall <= 33% PotSize) RaisePot FORCE
   WHEN Others RaiseBy (4 * BetSize) FORCE

##f$BetsizeRiverMultiway##
WHEN AmountToCall <= 1
   WHEN (PotSize <= 10) RaisePot FORCE
   WHEN Others RaiseBy 60% FORCE
WHEN Others
   WHEN (AmountToCall <= 33% PotSize) RaisePot FORCE
   WHEN Others RaiseBy (4 * BetSize) FORCE

##f$turn_raise_initiative##
[ Position = First ] ? {
    [ f$actionpostflop_free_to_play ] ? {
        [ nplayersplaying==2 AND nplayersround_flop==2 ] ? {
            [ didcallround_preflop AND nbetsround_preflop>1 AND nbetsround_preflop<=5 ] ? f$prwin>0 : // donkbet and 2nd barrel turn
            [ f$AggressionFactor_Turn2<=3.00 ] ? {
                [ f$draws>1   ] ? 1 :
                [ f$prwin>.70 AND NOT(ismidpair AND (rankhicommon == ace) AND NOT PairOnBoard) ] ? 1 : 0 } :
            [ f$AggressionFactor_Turn2>3.00 AND NOT(ismidpair AND (rankhicommon == ace) AND NOT PairOnBoard) ] ? f$prwin>.70 AND f$prwin<.80 : 0 } : // only barrel value oop
        [ nplayersplaying>=2 AND nplayersround_flop>=3 AND NOT(ismidpair AND (rankhicommon == ace) AND NOT PairOnBoard) ] ? f$prwin>.74 : 0 } :
    [ f$actionpostflop_opponent_min_bets ] ? f$prwin>.80 :
    [ f$actionpostflop_opponent_bets_medium ] ? f$prwin>.80 :
    [ f$actionpostflop_opponent_bets_pot ] ? f$prwin>.80 : // check push allin
    [ f$actionpostflop_opponent_overbets ] ? f$prwin>.90 :
    [ f$actionpostflop_opponent_min_reraises ] ? f$prwin>.85 :
    [ f$actionpostflop_opponent_reraises_normal ] ? f$prwin>.86 :
    [ f$actionpostflop_opponent_reraises_huge ] ? f$prwin>.97 :
    [ f$actionpostflop_medium_investment ] ? f$nuts      :
    [ f$actionpostflop_large_investment] ? f$nuts      : 0 } :
[ Position = Middle ] ? {
    [ f$actionpostflop_free_to_play ] ? f$prwin>.72 :
    [ f$actionpostflop_opponent_min_bets ] ? f$prwin>.80 :
    [ f$actionpostflop_opponent_bets_medium ] ? f$prwin>.85 :
    [ f$actionpostflop_opponent_bets_pot ] ? f$prwin>.90 :
    [ f$actionpostflop_opponent_overbets ] ? f$prwin>.95 :
    [ f$actionpostflop_opponent_min_reraises ] ? f$prwin>.96 :
    [ f$actionpostflop_opponent_reraises_normal ] ? f$prwin>.96 :
    [ f$actionpostflop_opponent_reraises_huge ] ? f$prwin>.97 :
    [ f$actionpostflop_medium_investment ] ? f$nuts      :
    [ f$actionpostflop_large_investment] ? f$nuts      : 0 } :
[ Position = Last ] ? {
    [ f$actionpostflop_free_to_play ] ? {
        [ nplayersplaying==2 AND nplayersround_flop==2 ] ? {
             [ f$prwin<0.72 AND NOT (ismidpair AND (rankhicommon == ace) AND NOT PairOnBoard) AND ranklocommon<10 AND nbetsround_preflop<7 AND nbetsround_flop<15 AND NOT PairOnBoard ] ? 1 :
             [ f$prwin>=0.78 ] ? 1 : 0 } :
        [ nplayersplaying>=2 AND nplayersround_flop>=3 AND ranklocommon<10 AND NOT (ismidpair AND (rankhicommon == ace) AND NOT PairOnBoard) ] ? f$prwin>0.65 : 0 } :
    [ f$actionpostflop_opponent_min_bets ] ? f$prwin>.80 :
    [ f$actionpostflop_opponent_bets_medium ] ? f$prwin>.80 :
    [ f$actionpostflop_opponent_bets_pot ] ? f$prwin>.85 :
    [ f$actionpostflop_opponent_overbets ] ? f$prwin>.95 :
    [ f$actionpostflop_opponent_min_reraises ] ? f$prwin>.96 :
    [ f$actionpostflop_opponent_reraises_normal ] ? f$prwin>.96 :
    [ f$actionpostflop_opponent_reraises_huge ] ? f$prwin>.97 :
    [ f$actionpostflop_medium_investment ] ? f$nuts      :
    [ f$actionpostflop_large_investment] ? f$nuts      : 0 } :
0

##f$turn_raise_noinitiative##
[ Position = First ] ? {
    [ nplayersplaying==2 ] ? {
        [ f$actionpostflop_free_to_play ] ? f$prwin>.88 : // check raise
        [ f$actionpostflop_opponent_min_bets ] ? f$prwin>.75 :
        [ f$actionpostflop_opponent_bets_medium ] ? f$prwin>.78 :
        [ f$actionpostflop_opponent_bets_pot ] ? f$prwin>.80 :
        [ f$actionpostflop_opponent_overbets ] ? f$prwin>.95 :
        [ f$actionpostflop_opponent_min_reraises ] ? f$prwin>.96 :
        [ f$actionpostflop_opponent_reraises_normal ] ? f$prwin>.97 :
        [ f$actionpostflop_opponent_reraises_huge ] ? f$prwin>.97 :
        [ f$actionpostflop_medium_investment ] ? f$nuts      :
        [ f$actionpostflop_large_investment] ? f$nuts      : 0 } :
    [ nplayersplaying>=3 ] ? {
        [ f$actionpostflop_free_to_play ] ? f$prwin>.75 AND f$prwin<.96 :
        [ f$actionpostflop_opponent_min_bets ] ? f$prwin>.96 :
        [ f$actionpostflop_opponent_bets_medium ] ? f$prwin>.96 :
        [ f$actionpostflop_opponent_bets_pot ] ? f$prwin>.96 :
        [ f$actionpostflop_opponent_overbets ] ? f$prwin>.96 :
        [ f$actionpostflop_opponent_min_reraises ] ? f$prwin>.96 :
        [ f$actionpostflop_opponent_reraises_normal ] ? f$prwin>.97 :
        [ f$actionpostflop_opponent_reraises_huge ] ? f$prwin>.97 :
        [ f$actionpostflop_medium_investment ] ? f$nuts      :
        [ f$actionpostflop_large_investment] ? f$nuts      : 0 } : 0 } :
[ Position = Middle ] ? {
    [ f$actionpostflop_free_to_play ] ? f$prwin>.80 :
    [ f$actionpostflop_opponent_min_bets ] ? f$prwin>.80 :
    [ f$actionpostflop_opponent_bets_medium ] ? f$prwin>.86 :
    [ f$actionpostflop_opponent_bets_pot ] ? f$prwin>.90 :
    [ f$actionpostflop_opponent_overbets ] ? f$prwin>.96 :
    [ f$actionpostflop_opponent_min_reraises ] ? f$prwin>.96 :
    [ f$actionpostflop_opponent_reraises_normal ] ? f$prwin>.97 :
    [ f$actionpostflop_opponent_reraises_huge ] ? f$prwin>.97 :
    [ f$actionpostflop_medium_investment ] ? f$nuts      :
    [ f$actionpostflop_large_investment] ? f$nuts      : 0 } :
[ Position = Last ] ? {
    [ f$actionpostflop_free_to_play ] ? f$prwin>.80 :
    [ f$actionpostflop_opponent_min_bets ] ? f$prwin>.80 :
    [ f$actionpostflop_opponent_bets_medium ] ? f$prwin>.80 :
    [ f$actionpostflop_opponent_bets_pot ] ? f$prwin>.90 :
    [ f$actionpostflop_opponent_overbets ] ? f$prwin>.96 :
    [ f$actionpostflop_opponent_min_reraises ] ? f$prwin>.98 :
    [ f$actionpostflop_opponent_reraises_normal ] ? f$prwin>.98 :
    [ f$actionpostflop_opponent_reraises_huge ] ? f$prwin>.98 :
    [ f$actionpostflop_medium_investment ] ? f$nuts      :
    [ f$actionpostflop_large_investment] ? f$nuts      : 0 } :
0

##f$turn_raise_noaction##
[ Position = First ] ? {
    [ f$actionpostflop_free_to_play ] ? {
        [ nplayersplaying==2 ] ? {
            [ f$draws>1   ] ? 1 :
            [ f$prwin>.64 ] ? 1 : 0 } :
        [ nplayersplaying>=3 ] ? f$prwin>.64 : 0 } :
    [ f$actionpostflop_opponent_min_bets ] ? f$prwin>.98 :
    [ f$actionpostflop_opponent_bets_medium ] ? f$prwin>.98 :
    [ f$actionpostflop_opponent_bets_pot ] ? f$prwin>.98 :
    [ f$actionpostflop_opponent_overbets ] ? f$prwin>.98 :
    [ f$actionpostflop_opponent_min_reraises ] ? f$prwin>.85 :
    [ f$actionpostflop_opponent_reraises_normal ] ? f$prwin>.85 : 
    [ f$actionpostflop_opponent_reraises_huge ] ? f$prwin>.95 :
    [ f$actionpostflop_medium_investment ] ? f$nuts      :
    [ f$actionpostflop_large_investment] ? f$nuts      : 0 } :
[ Position = Middle ] ? {
    [ f$actionpostflop_free_to_play ] ? {
        [ f$draws>1   ] ? 1 :
        [ f$prwin>.62 ] ? 1 : 0 } :
    [ f$actionpostflop_opponent_min_bets ] ? f$prwin>.80 :
    [ f$actionpostflop_opponent_bets_medium ] ? f$prwin>.80 :
    [ f$actionpostflop_opponent_bets_pot ] ? f$prwin>.82 :
    [ f$actionpostflop_opponent_overbets ] ? f$prwin>.86 :
    [ f$actionpostflop_opponent_min_reraises ] ? f$prwin>.95 :
    [ f$actionpostflop_opponent_reraises_normal ] ? f$prwin>.96 :
    [ f$actionpostflop_opponent_reraises_huge ] ? f$prwin>.97 :
    [ f$actionpostflop_medium_investment ] ? f$nuts      :
    [ f$actionpostflop_large_investment] ? f$nuts      : 0 } :
[ Position = Last ] ? {
    [ f$actionpostflop_free_to_play ] ? {
         [ nplayersround_flop==2 ] ? f$prwin>0 :
         [ nplayersround_flop>=3 ] ? {
             [ f$draws>1   ] ? 1 :
             [ f$prwin>.60 ] ? 1 : 0 } : 0 } :
    [ f$actionpostflop_opponent_min_bets ] ? f$prwin>.74 :
    [ f$actionpostflop_opponent_bets_medium ] ? f$prwin>.78 :
    [ f$actionpostflop_opponent_bets_pot ] ? f$prwin>.80 :
    [ f$actionpostflop_opponent_overbets ] ? f$prwin>.86 :
    [ f$actionpostflop_opponent_min_reraises ] ? f$prwin>.95 :
    [ f$actionpostflop_opponent_reraises_normal ] ? f$prwin>.96 :
    [ f$actionpostflop_opponent_reraises_huge ] ? f$prwin>.97 :
    [ f$actionpostflop_medium_investment ] ? f$nuts      :
    [ f$actionpostflop_large_investment] ? f$nuts      : 0 } :
0

##f$river_raise_initiative##
[ Position = First ] ? {
    [ f$actionpostflop_free_to_play ] ? {
      [ nplayersplaying==2 ] ? {
        [ f$draws>1 AND HaveFlushDraw AND f$pt_vpip>0.50 AND f$pt_wtsd>0.30 AND random>.50 ] ? 1 :
        [ f$pt_riveraf<2  ] ? f$prwin>.78 :
        [ f$pt_riveraf>=2 ] ? f$prwin>.90 : 0 } :
      [ nplayersplaying>=3 ] ? f$prwin>.80 : 0 } :
    [ f$actionpostflop_opponent_min_bets ] ? f$prwin>.80 :
    [ f$actionpostflop_opponent_bets_medium ] ? f$prwin>.98 :
    [ f$actionpostflop_opponent_bets_pot ] ? f$prwin>.98 :
    [ f$actionpostflop_opponent_overbets ] ? f$prwin>.98 :
    [ f$actionpostflop_opponent_min_reraises ] ? f$prwin>.95 :
    [ f$actionpostflop_opponent_reraises_normal ] ? f$prwin>.96 :
    [ f$actionpostflop_opponent_reraises_huge ] ? f$prwin>.97 :
    [ f$actionpostflop_medium_investment ] ? f$nuts      :
    [ f$actionpostflop_large_investment] ? f$nuts      : 0 } :
[ Position = Middle ] ? {
    [ f$actionpostflop_free_to_play ] ? f$prwin>.80 :
    [ f$actionpostflop_opponent_min_bets ] ? f$prwin>.86 :
    [ f$actionpostflop_opponent_bets_medium ] ? f$prwin>.90 :
    [ f$actionpostflop_opponent_bets_pot ] ? f$prwin>.96 :
    [ f$actionpostflop_opponent_overbets ] ? f$prwin>.98 :
    [ f$actionpostflop_opponent_min_reraises ] ? f$prwin>.95 :
    [ f$actionpostflop_opponent_reraises_normal ] ? f$prwin>.96 :
    [ f$actionpostflop_opponent_reraises_huge ] ? f$prwin>.97 :
    [ f$actionpostflop_medium_investment ] ? f$nuts      :
    [ f$actionpostflop_large_investment] ? f$nuts      : 0 } :
[ Position = Last ] ? {
    [ f$actionpostflop_free_to_play ] ? {
        [ nplayersplaying==2 AND nplayersround_flop==2 AND handsplayed>15 AND NOT f$safeboard1 AND NOT didcallround_preflop AND nbetsround_preflop>1 AND nbetsround_preflop<=6 AND didbetsizeround_flop AND NOT didcallround_flop AND nbetsround_flop<11 ] ? f$prwin>0.00 :
        [ nplayersplaying==2 AND nbetsround_flop==0 ] ? f$prwin>0.70 :
        [ nplayersplaying>=3 AND nbetsround_flop==0 ] ? f$prwin>0.75 :
        [ f$prwin>.80 ] ? 1 : 0 } :
    [ f$actionpostflop_opponent_min_bets ] ? f$prwin>.86 :
    [ f$actionpostflop_opponent_bets_medium ] ? f$prwin>.90 :
    [ f$actionpostflop_opponent_bets_pot ] ? f$prwin>.96 :
    [ f$actionpostflop_opponent_overbets ] ? f$prwin>.98 :
    [ f$actionpostflop_opponent_min_reraises ] ? f$prwin>.98 :
    [ f$actionpostflop_opponent_reraises_normal ] ? f$prwin>.98 :
    [ f$actionpostflop_opponent_reraises_huge ] ? f$prwin>.98 :
    [ f$actionpostflop_medium_investment ] ? f$nuts      :
    [ f$actionpostflop_large_investment] ? f$nuts      : 0 } :
0

##f$river_raise_noinitiative##
[ Position = First ] ? {
    [ f$actionpostflop_free_to_play ] ? f$prwin>.80 :
    [ f$actionpostflop_opponent_min_bets ] ? f$prwin>.90 :
    [ f$actionpostflop_opponent_bets_medium ] ? f$prwin>.90 :
    [ f$actionpostflop_opponent_bets_pot ] ? f$prwin>.90 :
    [ f$actionpostflop_opponent_overbets ] ? f$prwin>.90 :
    [ f$actionpostflop_opponent_min_reraises ] ? f$prwin>.96 :
    [ f$actionpostflop_opponent_reraises_normal ] ? f$prwin>.97 :
    [ f$actionpostflop_opponent_reraises_huge ] ? f$prwin>.97 :
    [ f$actionpostflop_medium_investment ] ? f$nuts      :
    [ f$actionpostflop_large_investment] ? f$nuts      : 0 } :
[ Position = Middle ] ? {
    [ f$actionpostflop_free_to_play ] ? f$prwin>.80 :
    [ f$actionpostflop_opponent_min_bets ] ? f$prwin>.80 :
    [ f$actionpostflop_opponent_bets_medium ] ? f$prwin>.86 :
    [ f$actionpostflop_opponent_bets_pot ] ? f$prwin>.90 :
    [ f$actionpostflop_opponent_overbets ] ? f$prwin>.96 :
    [ f$actionpostflop_opponent_min_reraises ] ? f$prwin>.96 :
    [ f$actionpostflop_opponent_reraises_normal ] ? f$prwin>.97 :
    [ f$actionpostflop_opponent_reraises_huge ] ? f$prwin>.97 :
    [ f$actionpostflop_medium_investment ] ? f$nuts      :
    [ f$actionpostflop_large_investment] ? f$nuts      : 0 } :
[ Position = Last ] ? {
    [ f$actionpostflop_free_to_play ] ? f$prwin>.80 :
    [ f$actionpostflop_opponent_min_bets ] ? f$prwin>.80 :
    [ f$actionpostflop_opponent_bets_medium ] ? f$prwin>.80 :
    [ f$actionpostflop_opponent_bets_pot ] ? f$prwin>.90 :
    [ f$actionpostflop_opponent_overbets ] ? f$prwin>.96 :
    [ f$actionpostflop_opponent_min_reraises ] ? f$prwin>.98 :
    [ f$actionpostflop_opponent_reraises_normal ] ? f$prwin>.98 :
    [ f$actionpostflop_opponent_reraises_huge ] ? f$prwin>.98 :
    [ f$actionpostflop_medium_investment ] ? f$nuts      :
    [ f$actionpostflop_large_investment] ? f$nuts      : 0 } :
0

##f$river_raise_noaction##
// Toevoegen NBETSround_preflop
[ Position = First ] ? {
    [ f$actionpostflop_free_to_play ] ? {
         [ nplayersround_flop==2 ] ? {
             [ nbetsround_preflop<6 AND nbetsround_flop<15 ] ? f$prwin>0 :
             [ f$prwin>.65                     ] ? 1         : 0 } :
         [ nplayersround_flop>=3 ] ? f$prwin>.65 : 0 } :
    [ f$actionpostflop_opponent_min_bets ] ? f$prwin>.98 :
    [ f$actionpostflop_opponent_bets_medium ] ? f$prwin>.98 :
    [ f$actionpostflop_opponent_bets_pot ] ? f$prwin>.98 :
    [ f$actionpostflop_opponent_overbets ] ? f$prwin>.98 :
    [ f$actionpostflop_opponent_min_reraises ] ? f$prwin>.95 :
    [ f$actionpostflop_opponent_reraises_normal ] ? f$prwin>.96 : 
    [ f$actionpostflop_opponent_reraises_huge ] ? f$prwin>.97 :
    [ f$actionpostflop_medium_investment ] ? f$nuts      :
    [ f$actionpostflop_large_investment] ? f$nuts      : 0 } :
[ Position = Middle ] ? {
    [ f$actionpostflop_free_to_play ] ? f$prwin>.64 :
    [ f$actionpostflop_opponent_min_bets ] ? f$prwin>.80 :
    [ f$actionpostflop_opponent_bets_medium ] ? f$prwin>.80 :
    [ f$actionpostflop_opponent_bets_pot ] ? f$prwin>.82 :
    [ f$actionpostflop_opponent_overbets ] ? f$prwin>.86 :
    [ f$actionpostflop_opponent_min_reraises ] ? f$prwin>.95 :
    [ f$actionpostflop_opponent_reraises_normal ] ? f$prwin>.96 :
    [ f$actionpostflop_opponent_reraises_huge ] ? f$prwin>.97 :
    [ f$actionpostflop_medium_investment ] ? f$nuts      :
    [ f$actionpostflop_large_investment] ? f$nuts      : 0 } :
[ Position = Last ] ? {
    [ f$actionpostflop_free_to_play ] ? {
         [ nplayersround_flop==2 ] ? f$prwin>.50 :
         [ nplayersround_flop>=3 ] ? f$prwin>.55 : 0 } :
    [ f$actionpostflop_opponent_min_bets ] ? f$prwin>.74 :
    [ f$actionpostflop_opponent_bets_medium ] ? f$prwin>.78 :
    [ f$actionpostflop_opponent_bets_pot ] ? f$prwin>.80 :
    [ f$actionpostflop_opponent_overbets ] ? f$prwin>.86 :
    [ f$actionpostflop_opponent_min_reraises ] ? f$prwin>.95 :
    [ f$actionpostflop_opponent_reraises_normal ] ? f$prwin>.96 :
    [ f$actionpostflop_opponent_reraises_huge ] ? f$prwin>.97 :
    [ f$actionpostflop_medium_investment ] ? f$nuts      :
    [ f$actionpostflop_large_investment] ? f$nuts      : 0 } :
0

##f$Odds_and_Outs##
IsFlop ? (f$OutOdds*2.0)>f$PotOdds :
IsTurn ? (f$OutOdds*1.2)>f$PotOdds : 0

##f$nOuts##
  f$nOuts_FlushDraw
+ f$nOuts_Overcards
+ f$nOuts_StraightDraw
+ f$nOuts_DrawingPair
+ f$nOuts_DrawingTwoPair
+ f$nOuts_DrawingSet
+ f$nOuts_BackdoorDraws

##f$nOuts_FlushDraw##
  (IsFlop AND nsuitedcommon==2 AND HaveFlushDraw AND NOT PairOnBoard   ? 9 : 0)
+ (IsFlop AND nsuitedcommon==2 AND HaveFlushDraw AND PairOnBoard       ? 8 : 0)
+ (IsTurn AND nsuitedcommon==2 AND HaveFlushDraw AND NOT PairOnBoard   ? 9 : 0)
+ (IsTurn AND nsuitedcommon==2 AND HaveFlushDraw AND PairOnBoard       ? 9 : 0)
+ (HaveThirdNutFlushDraw AND FlushPossible AND NOT PairOnBoard         ? 7 : 0)
+ (HaveThirdNutFlushDraw AND FlushPossible AND PairOnBoard             ? 5 : 0)
+ (HaveSecondNutFlushDraw AND FlushPossible AND NOT PairOnBoard        ? 8 : 0)
+ (HaveSecondNutFlushDraw AND FlushPossible AND PairOnBoard            ? 6 : 0)
+ (HaveNutFlushDraw AND FlushPossible AND NOT PairOnBoard              ? 9 : 0)
+ (HaveNutFlushDraw AND FlushPossible AND PairOnBoard                  ? 7 : 0)

##f$nOuts_Overcards##
  (IsFlop AND rankloplayer>rankhicommon AND nplayersplaying<=4 AND f$safeboard AND NOT isonepair                                      ? 6 : 0)
+ (IsFlop AND rankhiplayer>rankhicommon AND nplayersplaying<=4 AND f$safeboard AND NOT isonepair AND NOT(rankloplayer>rankhicommon)   ? 3 : 0)
+ (IsTurn AND rankloplayer>rankhicommon AND nbetsround_flop<3 AND nplayersplaying==2 AND NOT FlushPossible AND NOT StraightPossible AND nstraightfillcommon>1 AND NOT PairOnBoard AND NOT(isonepair AND NOT PairOnBoard) ? 6 : 0)
+ (IsTurn AND rankloplayer>rankhicommon AND nbetsround_flop<2 AND nplayersplaying==3 AND NOT FlushPossible AND NOT StraightPossible AND nstraightfillcommon>1 AND NOT PairOnBoard AND NOT(isonepair AND NOT PairOnBoard) ? 6 : 0)

##f$nOuts_StraightDraw##
  (nstraightcommon==3 AND nstraight==4 AND NOT FlushPossible AND NOT PairOnBoard AND NOT f$wheeldraw  ? 4 : 0)
+ (nstraightcommon==3 AND nstraight==4 AND NOT FlushPossible AND PairOnBoard AND NOT f$wheeldraw      ? 2 : 0)
+ (nstraightcommon==2 AND nstraight==4 AND NOT FlushPossible AND NOT PairOnBoard AND NOT f$wheeldraw  ? 8 : 0)
+ (nstraightcommon==2 AND nstraight==4 AND NOT FlushPossible AND PairOnBoard AND NOT f$wheeldraw      ? 6 : 0)
+ (nstraightcommon==1 AND nstraight==4 AND NOT FlushPossible AND NOT PairOnBoard AND NOT f$wheeldraw  ? 8 : 0)
+ (nstraightcommon==1 AND nstraight==4 AND NOT FlushPossible AND PairOnBoard AND NOT f$wheeldraw      ? 6 : 0)
+ (nstraightcommon<=3 AND nstraight==4 AND NOT FlushPossible AND nrankedcommon<=2 AND f$wheeldraw     ? 4 : 0)

##f$nOuts_DrawingPair##
  (f$safeboard AND PairInHand                                              ? 2 : 0)
+ (f$safeboard AND isonepair AND NOT PairInHand AND nstraightfillcommon>2  ? 5 : 0)

##f$nOuts_DrawingTwoPair##
  (NOT PairOnBoard AND istwopair AND NOT TwoPairOnBoard                ? 4 : 0)
+ (PairOnBoard AND istwopair AND NOT TwoPairOnBoard                    ? 1 : 0)

##f$nOuts_DrawingSet##
  (IsFlop AND isthreeofakind AND PairOnBoard AND NOT TripsOnBoard      ? 7 : 0)
+ (IsTurn AND isthreeofakind AND PairOnBoard AND NOT TripsOnBoard      ? 9 : 0)
+ (IsFlop AND isthreeofakind AND NOT PairOnBoard                       ? 7 : 0)
+ (IsTurn AND isthreeofakind AND NOT PairOnBoard                       ? 12: 0)

##f$nOuts_BackdoorDraws##
  (IsFlop AND HaveBackdoorFlushDraw AND nsuitedcommon==2 AND NOT PairOnBoard AND srankhiplayer>=king ? 1.5 : 0)
+ (IsFlop AND nstraightfill==2 AND NOT StraightPossible AND nsuitedcommon<2 AND NOT PairOnBoard      ? 1.0 : 0)

##f$OutOdds##
[ f$nOuts/46 ]

##f$PotOdds##
[call / (EffectivePotSizeInDollars + call + f$ImpliedOdds)]
    
##f$ImpliedOdds##
IsFlop ? ((nopponentsbetting*.50)*bet4*1.5) + (((nplayersplaying-1-nopponentsbetting)*.275)*bet4*1.25) : 
IsTurn ? ((nopponentsbetting*.50)*bet4) + (((nplayersplaying-1-nopponentsbetting)*.275)*bet4) : 0

##f$AggressionFactor##
[ IsFlop ] ? f$AggressionFactor_Flop  :
[ IsTurn ] ? f$AggressionFactor_Turn  :
[ IsRiver ] ? f$AggressionFactor_River : 0

##f$AggressionFactor_Flop##
WHEN f$actionpostflop_free_to_play RETURN 0.00 FORCE
WHEN pt_hands_raischair<=25 RETURN 0.00 FORCE
WHEN f$PT_Flop_AF_RaisChair<=0.00 RETURN 0.00 FORCE
WHEN f$PT_Flop_AF_RaisChair>0.00 AND f$PT_Flop_AF_RaisChair<=0.33 RETURN 0.40 FORCE
WHEN f$PT_Flop_AF_RaisChair>0.33 AND f$PT_Flop_AF_RaisChair<=0.66 RETURN 0.35 FORCE
WHEN f$PT_Flop_AF_RaisChair>0.66 AND f$PT_Flop_AF_RaisChair<=1.00 RETURN 0.25 FORCE
WHEN f$PT_Flop_AF_RaisChair>1.00 AND f$PT_Flop_AF_RaisChair<=1.33 RETURN 0.15 FORCE
WHEN f$PT_Flop_AF_RaisChair>1.33 AND f$PT_Flop_AF_RaisChair<=1.66 RETURN 0.05 FORCE

##f$AggressionFactor_Turn##
[ f$actionpostflop_free_to_play ] ? {
    [ f$Initiative_Hero   ] ? 0.00 :
    [ f$Initiative_Nobody ] ? 0.00 :
    [ f$Initiative_Villain AND f$pt_hands>25 ] ? {
                            f$pt_flopaf<=0.00 ? 0.00 :
        f$pt_flopaf>0.00 AND f$pt_flopaf<=0.33 ? 0.50 :
        f$pt_flopaf>0.33 AND f$pt_flopaf<=0.66 ? 0.40 :
        f$pt_flopaf>0.66 AND f$pt_flopaf<=1.00 ? 0.30 :
        f$pt_flopaf>1.00 AND f$pt_flopaf<=1.33 ? 0.20 :
        f$pt_flopaf>1.33 AND f$pt_flopaf<=1.66 ? 0.10 :
        0 } : 0 } :
[ call>0 AND pt_hands_raischair>25 ] ? {
  [ NOT didbetsize ] ? {
    [ f$PT_Turn_AF_RaisChair<=0.00 ] ? 0.00 :
    [ f$PT_Turn_AF_RaisChair>0.00 AND f$PT_Turn_AF_RaisChair<=0.25 ] ? 0.50 :
    [ f$PT_Turn_AF_RaisChair>0.25 AND f$PT_Turn_AF_RaisChair<=0.50 ] ? 0.40 :
    [ f$PT_Turn_AF_RaisChair>0.50 AND f$PT_Turn_AF_RaisChair<=0.75 ] ? 0.30 :
    [ f$PT_Turn_AF_RaisChair>0.75 AND f$PT_Turn_AF_RaisChair<=1.00 ] ? 0.20 :
    [ f$PT_Turn_AF_RaisChair>1.00 AND f$PT_Turn_AF_RaisChair<=1.25 ] ? 0.10 :
    [ f$PT_Turn_AF_RaisChair>1.25 AND f$PT_Turn_AF_RaisChair<=1.50 ] ? 0.05 :
    0 } : 
  [ didbetsize ] ? {
    [ f$PT_Turn_AF_RaisChair<=0.00 ] ? 0.00 :
    [ f$PT_Turn_AF_RaisChair>0.00 AND f$PT_Turn_AF_RaisChair<=0.25 ] ? 1.00 :
    [ f$PT_Turn_AF_RaisChair>0.25 AND f$PT_Turn_AF_RaisChair<=0.50 ] ? 0.65 :
    [ f$PT_Turn_AF_RaisChair>0.50 AND f$PT_Turn_AF_RaisChair<=0.75 ] ? 0.50 :
    [ f$PT_Turn_AF_RaisChair>0.75 AND f$PT_Turn_AF_RaisChair<=1.00 ] ? 0.33 :
    [ f$PT_Turn_AF_RaisChair>1.00 AND f$PT_Turn_AF_RaisChair<=1.25 ] ? 0.16 :
    0 } : 0 } :
0

##f$AggressionFactor_River##
[ f$actionpostflop_free_to_play ] ? {
    [ f$Initiative_Hero   ] ? 0 :
    [ f$Initiative_Nobody ] ? 0 :
    [ f$Initiative_Villain AND f$pt_hands>25 ] ? {
        [ f$pt_turnaf<=0.00 ] ? 0.00 :
        [ f$pt_turnaf>0.00 AND f$pt_turnaf<=0.25 ] ? 0.50 :
        [ f$pt_turnaf>0.25 AND f$pt_turnaf<=0.50 ] ? 0.40 :
        [ f$pt_turnaf>0.50 AND f$pt_turnaf<=0.75 ] ? 0.30 :
        [ f$pt_turnaf>0.75 AND f$pt_turnaf<=1.00 ] ? 0.20 :
        [ f$pt_turnaf>1.00 AND f$pt_turnaf<=1.25 ] ? 0.10 :
        [ f$pt_turnaf>1.25 AND f$pt_turnaf<=1.50 ] ? 0.05 :
        0 } : 0 } :
[ call>0 AND pt_hands_raischair>25 ] ? {
  [ NOT didbetsize ] ? {
    [ f$PT_River_AF_RaisChair<=0.00 ] ? 0.00 :
    [ f$PT_River_AF_RaisChair>0.00 AND f$PT_River_AF_RaisChair<=0.25 ] ? 0.50 :
    [ f$PT_River_AF_RaisChair>0.25 AND f$PT_River_AF_RaisChair<=0.50 ] ? 0.40 :
    [ f$PT_River_AF_RaisChair>0.50 AND f$PT_River_AF_RaisChair<=0.75 ] ? 0.30 :
    [ f$PT_River_AF_RaisChair>0.75 AND f$PT_River_AF_RaisChair<=1.00 ] ? 0.20 :
    [ f$PT_River_AF_RaisChair>1.00 AND f$PT_River_AF_RaisChair<=1.25 ] ? 0.10 :
    [ f$PT_River_AF_RaisChair>1.25 AND f$PT_River_AF_RaisChair<=1.50 ] ? 0.05 :
    0 } : 
  [ didbetsize ] ? {
    [ f$PT_River_AF_RaisChair<=0.00 ] ? 0.00 :
    [ f$PT_River_AF_RaisChair>0.00 AND f$PT_River_AF_RaisChair<=0.25 ] ? 1.00 :
    [ f$PT_River_AF_RaisChair>0.25 AND f$PT_River_AF_RaisChair<=0.50 ] ? 0.65 :
    [ f$PT_River_AF_RaisChair>0.50 AND f$PT_River_AF_RaisChair<=0.75 ] ? 0.50 :
    [ f$PT_River_AF_RaisChair>0.75 AND f$PT_River_AF_RaisChair<=1.00 ] ? 0.33 :
    [ f$PT_River_AF_RaisChair>1.00 AND f$PT_River_AF_RaisChair<=1.25 ] ? 0.16 :
    0 } : 0 } :
0

##f$threat##
IsFlop  ? (f$AggressionFactor_Flop+f$foldequity+f$villaintakeover+f$reducewinchance_when_have_twopair)  :
IsTurn  ? (f$AggressionFactor_Turn+f$foldequity+f$villaintakeover+f$reducewinchance_when_have_twopair)  :
IsRiver ?(f$AggressionFactor_River+f$foldequity+f$villaintakeover+f$reducewinchance_when_have_twopair) : 0

##f$flop_call_initiative##
[ Position = First ] ? {
    [ f$actionpostflop_opponent_min_bets ] ? f$prwin1>.15 :
    [ f$actionpostflop_opponent_bets_medium ] ? f$prwin1>.60 :
    [ f$actionpostflop_opponent_bets_pot ] ? f$prwin1>.65 :
    [ f$actionpostflop_opponent_overbets ] ? f$prwin1>.70 :
    [ f$actionpostflop_opponent_min_reraises ] ? {
        [ f$ptype_raise_contibet_very_low ] ? f$prwin2>.80 :
        [ f$ptype_raise_contibet_low     ] ? f$prwin2>.78 :
        [ f$ptype_raise_contibet_normal     ] ? f$prwin2>.75 :
        [ f$ptype_raise_contibet_high ] ? f$prwin2>.72 :
        [ f$ptype_raise_contibet_very_high     ] ? f$prwin2>.70 : 0 } :
    [ f$actionpostflop_opponent_reraises_normal ] ? {
        [ f$ptype_raise_contibet_very_low ] ? f$prwin2>.84 :
        [ f$ptype_raise_contibet_low     ] ? f$prwin2>.80 :
        [ f$ptype_raise_contibet_normal     ] ? f$prwin2>.78 :
        [ f$ptype_raise_contibet_high ] ? f$prwin2>.77 :
        [ f$ptype_raise_contibet_very_high     ] ? f$prwin2>.74 : 0 } :
    [ f$actionpostflop_opponent_reraises_huge ] ? {
        [ f$ptype_raise_contibet_very_low ] ? f$prwin2>.85 :
        [ f$ptype_raise_contibet_low     ] ? f$prwin2>.82 :
        [ f$ptype_raise_contibet_normal     ] ? f$prwin2>.78 :
        [ f$ptype_raise_contibet_high ] ? f$prwin2>.77 :
        [ f$ptype_raise_contibet_very_high     ] ? f$prwin2>.74 : 0 } :
    [ f$actionpostflop_medium_investment ] ? f$prwin1>.82 :
    [ f$actionpostflop_large_investment] ? f$prwin1>.86 : 0 } :
[ Position = Middle ] ? {
    [ f$actionpostflop_opponent_min_bets ] ? f$prwin1>.15 :
    [ f$actionpostflop_opponent_bets_medium ] ? f$prwin1>.60 :
    [ f$actionpostflop_opponent_bets_pot ] ? f$prwin1>.65 :
    [ f$actionpostflop_opponent_overbets ] ? f$prwin1>.70 :
    [ f$actionpostflop_opponent_min_reraises ] ? {
        [ f$ptype_raise_contibet_very_low ] ? f$prwin2>.82 :
        [ f$ptype_raise_contibet_low     ] ? f$prwin2>.80 :
        [ f$ptype_raise_contibet_normal     ] ? f$prwin2>.78 :
        [ f$ptype_raise_contibet_high ] ? f$prwin2>.75 :
        [ f$ptype_raise_contibet_very_high     ] ? f$prwin2>.72 : 0 } :
    [ f$actionpostflop_opponent_reraises_normal ] ? {
        [ f$ptype_raise_contibet_very_low ] ? f$prwin2>.85 :
        [ f$ptype_raise_contibet_low     ] ? f$prwin2>.82 :
        [ f$ptype_raise_contibet_normal     ] ? f$prwin2>.80 :
        [ f$ptype_raise_contibet_high ] ? f$prwin2>.77 :
        [ f$ptype_raise_contibet_very_high     ] ? f$prwin2>.74 : 0 } :
    [ f$actionpostflop_opponent_reraises_huge ] ? {
        [ f$ptype_raise_contibet_very_low ] ? f$prwin2>.85 :
        [ f$ptype_raise_contibet_low     ] ? f$prwin2>.82 :
        [ f$ptype_raise_contibet_normal     ] ? f$prwin2>.80 :
        [ f$ptype_raise_contibet_high ] ? f$prwin2>.77 :
        [ f$ptype_raise_contibet_very_high     ] ? f$prwin2>.74 : 0 } :
    [ f$actionpostflop_medium_investment ] ? f$prwin1>.82 :
    [ f$actionpostflop_large_investment] ? f$prwin1>.86 : 0 } :
[ Position = Last ] ? {
    [ f$actionpostflop_opponent_min_bets ] ? f$prwin1>.15 :
    [ f$actionpostflop_opponent_bets_medium ] ? f$prwin1>.60 :
    [ f$actionpostflop_opponent_bets_pot ] ? f$prwin1>.65 :
    [ f$actionpostflop_opponent_overbets ] ? f$prwin1>.70 :
    [ f$actionpostflop_opponent_min_reraises ] ? {
        [ f$ptype_raise_contibet_very_low ] ? f$prwin2>.80 :
        [ f$ptype_raise_contibet_low     ] ? f$prwin2>.78 :
        [ f$ptype_raise_contibet_normal     ] ? f$prwin2>.75 :
        [ f$ptype_raise_contibet_high ] ? f$prwin2>.72 :
        [ f$ptype_raise_contibet_very_high     ] ? f$prwin2>.70 : 0 } :
    [ f$actionpostflop_opponent_reraises_normal ] ? {
        [ f$ptype_raise_contibet_very_low ] ? f$prwin2>.85 :
        [ f$ptype_raise_contibet_low     ] ? f$prwin2>.82 :
        [ f$ptype_raise_contibet_normal     ] ? f$prwin2>.78 :
        [ f$ptype_raise_contibet_high ] ? f$prwin2>.77 :
        [ f$ptype_raise_contibet_very_high     ] ? f$prwin2>.74 : 0 } :
    [ f$actionpostflop_opponent_reraises_huge ] ? {
        [ f$ptype_raise_contibet_very_low ] ? f$prwin2>.85 :
        [ f$ptype_raise_contibet_low     ] ? f$prwin2>.82 :
        [ f$ptype_raise_contibet_normal     ] ? f$prwin2>.79 :
        [ f$ptype_raise_contibet_high ] ? f$prwin2>.77 :
        [ f$ptype_raise_contibet_very_high     ] ? f$prwin2>.74 : 0 } :
    [ f$actionpostflop_medium_investment ] ? f$prwin1>.82 :
    [ f$actionpostflop_large_investment] ? f$prwin1>.86 : 0 } :
0

##f$flop_call_noaction##
[ Position = First ] ? {
    [ f$actionpostflop_opponent_min_bets ] ? f$prwin1>.50 :
    [ f$actionpostflop_opponent_bets_medium ] ? f$prwin1>.60 :
    [ f$actionpostflop_opponent_bets_pot ] ? f$prwin1>.65 :
    [ f$actionpostflop_opponent_overbets ] ? f$prwin1>.70 :
    [ f$actionpostflop_opponent_min_reraises ] ? {
        [ f$ptype_raise_contibet_very_low ] ? f$prwin2>.85 :
        [ f$ptype_raise_contibet_low     ] ? f$prwin2>.82 :
        [ f$ptype_raise_contibet_normal     ] ? f$prwin2>.80 :
        [ f$ptype_raise_contibet_high ] ? f$prwin2>.77 :
        [ f$ptype_raise_contibet_very_high     ] ? f$prwin2>.74 : 0 } :
    [ f$actionpostflop_opponent_reraises_normal ] ? {
        [ f$ptype_raise_contibet_very_low ] ? f$prwin2>.85 :
        [ f$ptype_raise_contibet_low     ] ? f$prwin2>.82 :
        [ f$ptype_raise_contibet_normal     ] ? f$prwin2>.80 :
        [ f$ptype_raise_contibet_high ] ? f$prwin2>.77 :
        [ f$ptype_raise_contibet_very_high     ] ? f$prwin2>.74 : 0 } :
    [ f$actionpostflop_opponent_reraises_huge ] ? {
        [ f$ptype_raise_contibet_very_low ] ? f$prwin2>.85 :
        [ f$ptype_raise_contibet_low     ] ? f$prwin2>.82 :
        [ f$ptype_raise_contibet_normal     ] ? f$prwin2>.80 :
        [ f$ptype_raise_contibet_high ] ? f$prwin2>.77 :
        [ f$ptype_raise_contibet_very_high     ] ? f$prwin2>.74 : 0 } :
    [ f$actionpostflop_medium_investment ] ? f$prwin1>.82 :
    [ f$actionpostflop_large_investment] ? f$prwin1>.86 : 0 } :
[ Position = Middle ] ? {
    [ f$actionpostflop_opponent_min_bets ] ? f$prwin1>.50 :
    [ f$actionpostflop_opponent_bets_medium ] ? f$prwin1>.60 :
    [ f$actionpostflop_opponent_bets_pot ] ? f$prwin1>.65 :
    [ f$actionpostflop_opponent_overbets ] ? f$prwin1>.70 :
    [ f$actionpostflop_opponent_min_reraises ] ? {
        [ f$ptype_raise_contibet_very_low ] ? f$prwin2>.85 :
        [ f$ptype_raise_contibet_low     ] ? f$prwin2>.82 :
        [ f$ptype_raise_contibet_normal     ] ? f$prwin2>.80 :
        [ f$ptype_raise_contibet_high ] ? f$prwin2>.77 :
        [ f$ptype_raise_contibet_very_high     ] ? f$prwin2>.74 : 0 } :
    [ f$actionpostflop_opponent_reraises_normal ] ? {
        [ f$ptype_raise_contibet_very_low ] ? f$prwin2>.85 :
        [ f$ptype_raise_contibet_low     ] ? f$prwin2>.82 :
        [ f$ptype_raise_contibet_normal     ] ? f$prwin2>.80 :
        [ f$ptype_raise_contibet_high ] ? f$prwin2>.77 :
        [ f$ptype_raise_contibet_very_high     ] ? f$prwin2>.74 : 0 } :
    [ f$actionpostflop_opponent_reraises_huge ] ? {
        [ f$ptype_raise_contibet_very_low ] ? f$prwin2>.85 :
        [ f$ptype_raise_contibet_low     ] ? f$prwin2>.82 :
        [ f$ptype_raise_contibet_normal     ] ? f$prwin2>.80 :
        [ f$ptype_raise_contibet_high ] ? f$prwin2>.77 :
        [ f$ptype_raise_contibet_very_high     ] ? f$prwin2>.74 : 0 } :
    [ f$actionpostflop_medium_investment ] ? f$prwin1>.82 :
    [ f$actionpostflop_large_investment] ? f$prwin1>.86 : 0 } :
[ Position = Last ] ? {
    [ f$actionpostflop_opponent_min_bets ] ? f$prwin1>.60 :
    [ f$actionpostflop_opponent_bets_medium ] ? f$prwin1>.65 :
    [ f$actionpostflop_opponent_bets_pot ] ? f$prwin1>.70 :
    [ f$actionpostflop_opponent_overbets ] ? f$prwin1>.80 :
    [ f$actionpostflop_opponent_min_reraises ] ? {
        [ f$ptype_raise_contibet_very_low ] ? f$prwin2>.85 :
        [ f$ptype_raise_contibet_low     ] ? f$prwin2>.82 :
        [ f$ptype_raise_contibet_normal     ] ? f$prwin2>.80 :
        [ f$ptype_raise_contibet_high ] ? f$prwin2>.77 :
        [ f$ptype_raise_contibet_very_high     ] ? f$prwin2>.74 : 0 } :
    [ f$actionpostflop_opponent_reraises_normal ] ? {
        [ f$ptype_raise_contibet_very_low ] ? f$prwin2>.85 :
        [ f$ptype_raise_contibet_low     ] ? f$prwin2>.82 :
        [ f$ptype_raise_contibet_normal     ] ? f$prwin2>.80 :
        [ f$ptype_raise_contibet_high ] ? f$prwin2>.77 :
        [ f$ptype_raise_contibet_very_high     ] ? f$prwin2>.74 : 0 } :
    [ f$actionpostflop_opponent_reraises_huge ] ? {
        [ f$ptype_raise_contibet_very_low ] ? f$prwin2>.85 :
        [ f$ptype_raise_contibet_low     ] ? f$prwin2>.82 :
        [ f$ptype_raise_contibet_normal     ] ? f$prwin2>.80 :
        [ f$ptype_raise_contibet_high ] ? f$prwin2>.77 :
        [ f$ptype_raise_contibet_very_high     ] ? f$prwin2>.74 : 0 } :
    [ f$actionpostflop_medium_investment ] ? f$prwin1>.82 :
    [ f$actionpostflop_large_investment] ? f$prwin1>.86 : 0 } :
0

##f$flop_call_noinitiative##
[ Position = First ] ? {
    [ f$actionpostflop_opponent_min_bets ] ? f$prwin1>.15 :
    [ f$actionpostflop_opponent_bets_medium ] ? f$prwin1>.60 :
    [ f$actionpostflop_opponent_bets_pot ] ? f$prwin1>.65 :
    [ f$actionpostflop_opponent_overbets ] ? f$prwin1>.70 :
    [ f$actionpostflop_opponent_min_reraises ] ? {
        [ f$ptype_raise_contibet_very_low ] ? f$prwin2>.85 :
        [ f$ptype_raise_contibet_low     ] ? f$prwin2>.82 :
        [ f$ptype_raise_contibet_normal     ] ? f$prwin2>.80 :
        [ f$ptype_raise_contibet_high ] ? f$prwin2>.77 :
        [ f$ptype_raise_contibet_very_high     ] ? f$prwin2>.74 : 0 } :
    [ f$actionpostflop_opponent_reraises_normal ] ? {
        [ f$ptype_raise_contibet_very_low ] ? f$prwin2>.85 :
        [ f$ptype_raise_contibet_low     ] ? f$prwin2>.82 :
        [ f$ptype_raise_contibet_normal     ] ? f$prwin2>.80 :
        [ f$ptype_raise_contibet_high ] ? f$prwin2>.77 :
        [ f$ptype_raise_contibet_very_high     ] ? f$prwin2>.74 : 0 } :
    [ f$actionpostflop_opponent_reraises_huge ] ? {
        [ f$ptype_raise_contibet_very_low ] ? f$prwin2>.85 :
        [ f$ptype_raise_contibet_low     ] ? f$prwin2>.82 :
        [ f$ptype_raise_contibet_normal     ] ? f$prwin2>.80 :
        [ f$ptype_raise_contibet_high ] ? f$prwin2>.77 :
        [ f$ptype_raise_contibet_very_high     ] ? f$prwin2>.74 : 0 } :
    [ f$actionpostflop_medium_investment ] ? f$prwin1>.82 :
    [ f$actionpostflop_large_investment] ? f$prwin1>.86 : 0 } :
[ Position = Middle ] ? {
    [ f$actionpostflop_opponent_min_bets ] ? f$prwin1>.15 :
    [ f$actionpostflop_opponent_bets_medium ] ? f$prwin1>.60 :
    [ f$actionpostflop_opponent_bets_pot ] ? f$prwin1>.65 :
    [ f$actionpostflop_opponent_overbets ] ? f$prwin1>.70 :
    [ f$actionpostflop_opponent_min_reraises ] ? {
        [ f$ptype_raise_contibet_very_low ] ? f$prwin2>.85 :
        [ f$ptype_raise_contibet_low     ] ? f$prwin2>.82 :
        [ f$ptype_raise_contibet_normal     ] ? f$prwin2>.80 :
        [ f$ptype_raise_contibet_high ] ? f$prwin2>.77 :
        [ f$ptype_raise_contibet_very_high     ] ? f$prwin2>.74 : 0 } :
    [ f$actionpostflop_opponent_reraises_normal ] ? {
        [ f$ptype_raise_contibet_very_low ] ? f$prwin2>.85 :
        [ f$ptype_raise_contibet_low     ] ? f$prwin2>.82 :
        [ f$ptype_raise_contibet_normal     ] ? f$prwin2>.80 :
        [ f$ptype_raise_contibet_high ] ? f$prwin2>.77 :
        [ f$ptype_raise_contibet_very_high     ] ? f$prwin2>.74 : 0 } :
    [ f$actionpostflop_opponent_reraises_huge ] ? {
        [ f$ptype_raise_contibet_very_low ] ? f$prwin2>.85 :
        [ f$ptype_raise_contibet_low     ] ? f$prwin2>.82 :
        [ f$ptype_raise_contibet_normal     ] ? f$prwin2>.80 :
        [ f$ptype_raise_contibet_high ] ? f$prwin2>.77 :
        [ f$ptype_raise_contibet_very_high     ] ? f$prwin2>.74 : 0 } :
    [ f$actionpostflop_medium_investment ] ? f$prwin1>.82 :
    [ f$actionpostflop_large_investment] ? f$prwin1>.86 : 0 } :
[ Position = Last ] ? {
    [ f$actionpostflop_opponent_min_bets ] ? f$prwin1>.15 :
    [ f$actionpostflop_opponent_bets_medium ] ? f$prwin1>.60 :
    [ f$actionpostflop_opponent_bets_pot ] ? f$prwin1>.65 :
    [ f$actionpostflop_opponent_overbets ] ? f$prwin1>.70 :
    [ f$actionpostflop_opponent_min_reraises ] ? {
        [ f$ptype_raise_contibet_very_low ] ? f$prwin2>.85 :
        [ f$ptype_raise_contibet_low     ] ? f$prwin2>.82 :
        [ f$ptype_raise_contibet_normal     ] ? f$prwin2>.80 :
        [ f$ptype_raise_contibet_high ] ? f$prwin2>.77 :
        [ f$ptype_raise_contibet_very_high     ] ? f$prwin2>.74 : 0 } :
    [ f$actionpostflop_opponent_reraises_normal ] ? {
        [ f$ptype_raise_contibet_very_low ] ? f$prwin2>.85 :
        [ f$ptype_raise_contibet_low     ] ? f$prwin2>.82 :
        [ f$ptype_raise_contibet_normal     ] ? f$prwin2>.80 :
        [ f$ptype_raise_contibet_high ] ? f$prwin2>.77 :
        [ f$ptype_raise_contibet_very_high     ] ? f$prwin2>.74 : 0 } :
    [ f$actionpostflop_opponent_reraises_huge ] ? {
        [ f$ptype_raise_contibet_very_low ] ? f$prwin2>.85 :
        [ f$ptype_raise_contibet_low     ] ? f$prwin2>.82 :
        [ f$ptype_raise_contibet_normal     ] ? f$prwin2>.80 :
        [ f$ptype_raise_contibet_high ] ? f$prwin2>.77 :
        [ f$ptype_raise_contibet_very_high     ] ? f$prwin2>.74 : 0 } :
    [ f$actionpostflop_medium_investment ] ? f$prwin1>.82 :
    [ f$actionpostflop_large_investment] ? f$prwin1>.86 : 0 } :
0

##f$turn_call_initiative##
[ Position = First ] ? {
    [ f$actionpostflop_opponent_min_bets ] ? f$prwin1>.55 :
    [ f$actionpostflop_opponent_bets_medium ] ? f$prwin1>.75 :
    [ f$actionpostflop_opponent_bets_pot ] ? f$prwin1>.77 :
    [ f$actionpostflop_opponent_overbets ] ? f$prwin1>.95 :
    [ f$actionpostflop_opponent_min_reraises ] ? f$prwin1>.82 :
    [ f$actionpostflop_opponent_reraises_normal ] ? f$prwin1>.95 :
    [ f$actionpostflop_opponent_reraises_huge ] ? f$prwin1>.95 :
    [ f$actionpostflop_medium_investment ] ? f$prwin1>.95 :
    [ f$actionpostflop_large_investment] ? f$prwin1>.97 : 0 } :
[ Position = Middle ] ? {
    [ f$actionpostflop_opponent_min_bets ] ? f$prwin1>.60 :
    [ f$actionpostflop_opponent_bets_medium ] ? f$prwin1>.80 :
    [ f$actionpostflop_opponent_bets_pot ] ? f$prwin1>.80 :
    [ f$actionpostflop_opponent_overbets ] ? f$prwin1>.95 :
    [ f$actionpostflop_opponent_min_reraises ] ? f$prwin1>.85 :
    [ f$actionpostflop_opponent_reraises_normal ] ? f$prwin1>.95 :
    [ f$actionpostflop_opponent_reraises_huge ] ? f$prwin1>.95 :
    [ f$actionpostflop_medium_investment ] ? f$prwin1>.95 :
    [ f$actionpostflop_large_investment] ? f$prwin1>.97 : 0 } :
[ Position = Last ] ? {
    [ f$actionpostflop_opponent_min_bets ] ? f$prwin1>.60 :
    [ f$actionpostflop_opponent_bets_medium ] ? f$prwin1>.75 :
    [ f$actionpostflop_opponent_bets_pot ] ? f$prwin1>.77 :
    [ f$actionpostflop_opponent_overbets ] ? f$prwin1>.95 :
    [ f$actionpostflop_opponent_min_reraises ] ? f$prwin1>.85 :
    [ f$actionpostflop_opponent_reraises_normal ] ? f$prwin1>.95 :
    [ f$actionpostflop_opponent_reraises_huge ] ? f$prwin1>.95 :
    [ f$actionpostflop_medium_investment ] ? f$prwin1>.95 :
    [ f$actionpostflop_large_investment] ? f$prwin1>.97 : 0 } :
0

##f$river_call_initiative##
[ f$actionpostflop_opponent_min_bets ] ? f$prwin1>.50 :
[ f$actionpostflop_opponent_bets_medium ] ? {
    [ nplayersplaying==2 ] ? f$prwin>.65 :
    [ nplayersplaying>=3 ] ? f$prwin>.70 : 0 } :
[ f$actionpostflop_opponent_bets_pot ] ? {
    [ nplayersplaying==2 ] ? f$prwin>.80 :
    [ nplayersplaying>=3 ] ? f$prwin>.75 : 0 } :
[ f$actionpostflop_opponent_overbets ] ? {
    [ nplayersplaying==2 ] ? f$prwin>.90 :
    [ nplayersplaying>=3 ] ? f$prwin>.95 : 0 } :
[ f$actionpostflop_opponent_min_reraises  ] ? f$prwin1>.78 :
[ f$actionpostflop_opponent_reraises_normal  ] ? f$prwin1>.82 :
[ f$actionpostflop_opponent_reraises_huge  ] ? f$prwin1>.95 :
[ f$actionpostflop_medium_investment  ] ? f$prwin1>.95 :
[ f$actionpostflop_large_investment ] ? f$prwin1>.97 :
0

##f$turn_call_noaction##
[ Position = First ] ? {
    [ f$actionpostflop_opponent_min_bets ] ? f$prwin1>.50 :
    [ f$actionpostflop_opponent_bets_medium ] ? f$prwin1>.75 :
    [ f$actionpostflop_opponent_bets_pot ] ? f$prwin1>.78 :
    [ f$actionpostflop_opponent_overbets ] ? f$prwin1>.95 :
    [ f$actionpostflop_opponent_min_reraises ] ? f$prwin1>.78 :
    [ f$actionpostflop_opponent_reraises_normal ] ? f$prwin1>.85 :
    [ f$actionpostflop_opponent_reraises_huge ] ? f$prwin1>.95 :
    [ f$actionpostflop_medium_investment ] ? f$prwin1>.95 :
    [ f$actionpostflop_large_investment] ? f$prwin1>.97 : 0 } :
[ Position = Middle ] ? {
    [ f$actionpostflop_opponent_min_bets ] ? f$prwin1>.55 :
    [ f$actionpostflop_opponent_bets_medium ] ? f$prwin1>.75 :
    [ f$actionpostflop_opponent_bets_pot ] ? f$prwin1>.78 :
    [ f$actionpostflop_opponent_overbets ] ? f$prwin1>.95 :
    [ f$actionpostflop_opponent_min_reraises ] ? f$prwin1>.80 :
    [ f$actionpostflop_opponent_reraises_normal ] ? f$prwin1>.85 :
    [ f$actionpostflop_opponent_reraises_huge ] ? f$prwin1>.95 :
    [ f$actionpostflop_medium_investment ] ? f$prwin1>.95 :
    [ f$actionpostflop_large_investment] ? f$prwin1>.97 : 0 } :
[ Position = Last ] ? {
    [ f$actionpostflop_opponent_min_bets ] ? f$prwin1>.60 :
    [ f$actionpostflop_opponent_bets_medium ] ? f$prwin1>.75 :
    [ f$actionpostflop_opponent_bets_pot ] ? f$prwin1>.78 :
    [ f$actionpostflop_opponent_overbets ] ? f$prwin1>.95 :
    [ f$actionpostflop_opponent_min_reraises ] ? f$prwin1>.82 :
    [ f$actionpostflop_opponent_reraises_normal ] ? f$prwin1>.86 :
    [ f$actionpostflop_opponent_reraises_huge ] ? f$prwin1>.95 :
    [ f$actionpostflop_medium_investment ] ? f$prwin1>.95 :
    [ f$actionpostflop_large_investment] ? f$prwin1>.97 : 0 } :
0

##f$river_call_noaction##
[ f$actionpostflop_opponent_min_bets ] ? f$prwin1>.50 :
[ f$actionpostflop_opponent_bets_medium ] ? {
    [ nplayersplaying==2 ] ? f$prwin>.65 :
    [ nplayersplaying>=3 ] ? f$prwin>.70 : 0 } :
[ f$actionpostflop_opponent_bets_pot ] ? {
    [ nplayersplaying==2 ] ? f$prwin>.80 :
    [ nplayersplaying>=3 ] ? f$prwin>.75 : 0 } :
[ f$actionpostflop_opponent_overbets ] ? {
    [ nplayersplaying==2 ] ? f$prwin>.90 :
    [ nplayersplaying>=3 ] ? f$prwin>.95 : 0 } :
[ f$actionpostflop_opponent_min_reraises  ] ? f$prwin1>.78 :
[ f$actionpostflop_opponent_reraises_normal  ] ? f$prwin1>.82 :
[ f$actionpostflop_opponent_reraises_huge  ] ? f$prwin1>.95 :
[ f$actionpostflop_medium_investment  ] ? f$prwin1>.95 :
[ f$actionpostflop_large_investment ] ? f$prwin1>.97 :
0

##f$river_call_noinitiative##
[ f$actionpostflop_opponent_min_bets ] ? f$prwin1>.50 :
[ f$actionpostflop_opponent_bets_medium ] ? {
    [ nplayersplaying==2 ] ? f$prwin>.65 :
    [ nplayersplaying>=3 ] ? f$prwin>.70 : 0 } :
[ f$actionpostflop_opponent_bets_pot ] ? {
    [ nplayersplaying==2 ] ? f$prwin>.80 :
    [ nplayersplaying>=3 ] ? f$prwin>.75 : 0 } :
[ f$actionpostflop_opponent_overbets ] ? {
    [ nplayersplaying==2 ] ? f$prwin>.90 :
    [ nplayersplaying>=3 ] ? f$prwin>.95 : 0 } :
[ f$actionpostflop_opponent_min_reraises  ] ? f$prwin1>.78 :
[ f$actionpostflop_opponent_reraises_normal  ] ? f$prwin1>.82 :
[ f$actionpostflop_opponent_reraises_huge  ] ? f$prwin1>.95 :
[ f$actionpostflop_medium_investment  ] ? f$prwin1>.95 :
[ f$actionpostflop_large_investment ] ? f$prwin1>.97 :
0

##f$turn_call_noinitiative##
[ Position = First ] ? {
    [ f$actionpostflop_opponent_min_bets ] ? f$prwin1>.50 :
    [ f$actionpostflop_opponent_bets_medium ] ? f$prwin1>.70 :
    [ f$actionpostflop_opponent_bets_pot ] ? f$prwin1>.70 :
    [ f$actionpostflop_opponent_overbets ] ? f$prwin1>.90 :
    [ f$actionpostflop_opponent_min_reraises ] ? f$prwin1>.82 :
    [ f$actionpostflop_opponent_reraises_normal ] ? f$prwin1>.88 :
    [ f$actionpostflop_opponent_reraises_huge ] ? f$prwin1>.95 :
    [ f$actionpostflop_medium_investment ] ? f$prwin1>.95 :
    [ f$actionpostflop_large_investment] ? f$prwin1>.97 : 0 } :
[ Position = Middle ] ? {
    [ f$actionpostflop_opponent_min_bets ] ? f$prwin1>.55 :
    [ f$actionpostflop_opponent_bets_medium ] ? f$prwin1>.70 :
    [ f$actionpostflop_opponent_bets_pot ] ? f$prwin1>.70 :
    [ f$actionpostflop_opponent_overbets ] ? f$prwin1>.90 :
    [ f$actionpostflop_opponent_min_reraises ] ? f$prwin1>.80 :
    [ f$actionpostflop_opponent_reraises_normal ] ? f$prwin1>.90 :
    [ f$actionpostflop_opponent_reraises_huge ] ? f$prwin1>.95 :
    [ f$actionpostflop_medium_investment ] ? f$prwin1>.95 :
    [ f$actionpostflop_large_investment] ? f$prwin1>.97 : 0 } :
[ Position = Last ] ? {
    [ f$actionpostflop_opponent_min_bets ] ? f$prwin1>.50 :
    [ f$actionpostflop_opponent_bets_medium ] ? f$prwin1>.70 :
    [ f$actionpostflop_opponent_bets_pot ] ? f$prwin1>.70 :
    [ f$actionpostflop_opponent_overbets ] ? f$prwin1>.95 :
    [ f$actionpostflop_opponent_min_reraises ] ? f$prwin1>.85 :
    [ f$actionpostflop_opponent_reraises_normal ] ? f$prwin1>.90 :
    [ f$actionpostflop_opponent_reraises_huge ] ? f$prwin1>.95 :
    [ f$actionpostflop_medium_investment ] ? f$prwin1>.95 :
    [ f$actionpostflop_large_investment] ? f$prwin1>.97 : 0 } :
0

##f$effective_balance_to_call_ratio##
WHEN (call <= 0) RETURN StackSize FORCE
WHEN ((balance + currentbet) <= f$stackraiser) RETURN ((balance + currentbet) / call) FORCE
WHEN Others RETURN (f$stackraiser / call) FORCE

##f$required_balance_to_call_ratio_for_setmining##
// Higher requirements in unraised pots, less likely to get action postflop
// Higher requirements OOP
// http://www.maxinmontreal.com/forums/viewtopic.php?f=297&t=21070&start=60#p147986
WHEN (BotsLastAction = None)
   WHEN (Raises = 0) RETURN 20 FORCE
   WHEN ((Raises = 1) AND ac_agchair_after) RETURN 15 FORCE
   WHEN ((Raises = 1) AND NOT ac_agchair_after) RETURN 12 FORCE
WHEN (BotsLastAction = Call) 
   WHEN ((RaisesSinceLastPlay = 1) AND ac_agchair_after) RETURN 12 FORCE
   WHEN ((RaisesSinceLastPlay = 1) AND NOT ac_agchair_after) RETURN 10 FORCE
WHEN (BotsLastAction = Raise) 
   WHEN ((RaisesSinceLastPlay = 1) AND ac_agchair_after) RETURN 12 FORCE
   WHEN ((RaisesSinceLastPlay = 1) AND NOT ac_agchair_after) RETURN 10 FORCE   
WHEN Others
   // Multiple raises, we don't want to call
   WHEN Others RETURN 999 FORCE
   
##f$preflop_call_for_setmining##
// Rules are the same for raised and reraised pots.
// Different balance-to-call-ratios get handled by f$required_balance_to_call_ratio_for_setmining.
// "Setmining"-range also contains some premium-hands
WHEN Raises <= 0 RETURN false FORCE
WHEN (f$effective_balance_to_call_ratio < f$required_balance_to_call_ratio_for_setmining) RETURN false FORCE
WHEN (AmountToCall > 0.50 * EffectivePotSize) RETURN false FORCE
WHEN listGeckoSetMining RETURN true FORCE

##f$preflop_call_reraise##
// Call any min-reraise
WHEN [didbetsize AND (4 * AmountToCall < EffectivePotSize)] RETURN true FORCE
// With premium hands we make action.
// Raises after setmining get handled be f$preflop_call_for_setmining.
   
##f$preflop_limp_good_hand##
WHEN [ncallbets > 1] RETURN false FORCE
WHEN [BotsLastAction != None] RETURN false FORCE
WHEN [InSmallBlind AND (handrank169 < 50)] RETURN true FORCE
WHEN [nopponentscalling==0 AND PairInHand] RETURN true FORCE
WHEN [nopponentscalling==1 AND listGeckoLimpAgainstOneOpponent] RETURN true FORCE
WHEN [nopponentscalling>=2 AND (listGeckoLimpMultiway)] RETURN true FORCE
   
##f$preflop_call##
WHEN (hand$AA OR hand$KK) RETURN true FORCE
WHEN f$preflop_call_for_setmining RETURN true FORCE
WHEN f$preflop_call_reraise RETURN true FORCE
WHEN f$preflop_limp_good_hand RETURN true FORCE
  
##f$stackopponent##
balance_headsupchair

##f$stackraiser##
WHEN (raischair >= 0) RETURN (balance_raischair + currentbet_raischair) FORCE

##f$foldequity##
[ f$Initiative_Nobody AND nplayersplaying==2 AND call==0 AND f$pt_hands>50 ] ? {
    [ Position = First ] ? {
        [ IsFlop AND EffectivePotSize < 6 ] ? {
            [                      f$pt_wtsd<=0.00 ] ?  0.00 :
            [ f$pt_wtsd>0.00 AND f$pt_wtsd<=0.10 ] ? -0.50 :
            [ f$pt_wtsd>0.10 AND f$pt_wtsd<=0.15 ] ? -0.30 :
            [ f$pt_wtsd>0.15 AND f$pt_wtsd<=0.20 ] ? -0.20 :
            [ f$pt_wtsd>0.20 AND f$pt_wtsd<=0.25 ] ? -0.05 :
            [ f$pt_wtsd>0.25 AND f$pt_wtsd<=0.30 ] ?  0.05 :
            [ f$pt_wtsd>0.30 AND f$pt_wtsd<=0.40 ] ?  0.15 :
            [ f$pt_wtsd>0.40 AND f$pt_wtsd<=0.50 ] ?  0.30 :
            [ f$pt_wtsd>0.50 AND f$pt_wtsd<=0.70 ] ?  0.40 :
            [ f$pt_wtsd>0.70                       ] ?  0.50 : 0 } :
        [ IsTurn AND EffectivePotSize < 12 ] ? {
            [                      f$pt_wtsd<=0.00 ] ?  0.00 :
            [ f$pt_wtsd>0.00 AND f$pt_wtsd<=0.10 ] ? -0.50 :
            [ f$pt_wtsd>0.10 AND f$pt_wtsd<=0.15 ] ? -0.30 :
            [ f$pt_wtsd>0.15 AND f$pt_wtsd<=0.20 ] ? -0.20 :
            [ f$pt_wtsd>0.20 AND f$pt_wtsd<=0.25 ] ? -0.05 :
            [ f$pt_wtsd>0.25 AND f$pt_wtsd<=0.30 ] ?  0.05 :
            [ f$pt_wtsd>0.30 AND f$pt_wtsd<=0.40 ] ?  0.15 :
            [ f$pt_wtsd>0.40 AND f$pt_wtsd<=0.50 ] ?  0.30 :
            [ f$pt_wtsd>0.50 AND f$pt_wtsd<=0.70 ] ?  0.40 :
            [ f$pt_wtsd>0.70                       ] ?  0.50 : 0 } :
        [ IsRiver AND NOT didcallround_flop AND EffectivePotSize < 32 ] ? {
            [                      f$pt_wtsd<=0.00 ] ?  0.00 :
            [ f$pt_wtsd>0.00 AND f$pt_wtsd<=0.10 ] ? -0.50 :
            [ f$pt_wtsd>0.10 AND f$pt_wtsd<=0.15 ] ? -0.30 :
            [ f$pt_wtsd>0.15 AND f$pt_wtsd<=0.20 ] ? -0.20 :
            [ f$pt_wtsd>0.20 AND f$pt_wtsd<=0.25 ] ? -0.05 :
            [ f$pt_wtsd>0.25 AND f$pt_wtsd<=0.30 ] ?  0.05 :
            [ f$pt_wtsd>0.30 AND f$pt_wtsd<=0.40 ] ?  0.15 :
            [ f$pt_wtsd>0.40 AND f$pt_wtsd<=0.50 ] ?  0.30 :
            [ f$pt_wtsd>0.50 AND f$pt_wtsd<=0.70 ] ?  0.40 :
            [ f$pt_wtsd>0.70                       ] ?  0.50 : 0 } : 0 } :
    [ Position = Last ] ? {
        [ IsFlop AND EffectivePotSize < 6 ] ? {
            [                      f$pt_wtsd<=0.00 ] ?  0.00 :
            [ f$pt_wtsd>0.00 AND f$pt_wtsd<=0.10 ] ? -0.50 :
            [ f$pt_wtsd>0.10 AND f$pt_wtsd<=0.15 ] ? -0.30 :
            [ f$pt_wtsd>0.15 AND f$pt_wtsd<=0.20 ] ? -0.20 :
            [ f$pt_wtsd>0.20 AND f$pt_wtsd<=0.25 ] ? -0.05 :
            [ f$pt_wtsd>0.25 AND f$pt_wtsd<=0.30 ] ?  0.05 :
            [ f$pt_wtsd>0.30 AND f$pt_wtsd<=0.40 ] ?  0.15 :
            [ f$pt_wtsd>0.40 AND f$pt_wtsd<=0.50 ] ?  0.30 :
            [ f$pt_wtsd>0.50 AND f$pt_wtsd<=0.70 ] ?  0.40 :
            [ f$pt_wtsd>0.70                       ] ?  0.50 : 0 } :
        [ IsTurn AND EffectivePotSize < 12 ] ? {
            [                      f$pt_wtsd<=0.00 ] ?  0.00 :
            [ f$pt_wtsd>0.00 AND f$pt_wtsd<=0.10 ] ? -0.50 :
            [ f$pt_wtsd>0.10 AND f$pt_wtsd<=0.15 ] ? -0.30 :
            [ f$pt_wtsd>0.15 AND f$pt_wtsd<=0.20 ] ? -0.20 :
            [ f$pt_wtsd>0.20 AND f$pt_wtsd<=0.25 ] ? -0.05 :
            [ f$pt_wtsd>0.25 AND f$pt_wtsd<=0.30 ] ?  0.05 :
            [ f$pt_wtsd>0.30 AND f$pt_wtsd<=0.40 ] ?  0.15 :
            [ f$pt_wtsd>0.40 AND f$pt_wtsd<=0.50 ] ?  0.30 :
            [ f$pt_wtsd>0.50 AND f$pt_wtsd<=0.70 ] ?  0.40 :
            [ f$pt_wtsd>0.70                       ] ?  0.50 : 0 } :
        [ IsRiver AND NOT didcallround_flop AND EffectivePotSize < 32 ] ? {
            [                      f$pt_wtsd<=0.00 ] ?  0.00 :
            [ f$pt_wtsd>0.00 AND f$pt_wtsd<=0.10 ] ? -0.50 :
            [ f$pt_wtsd>0.10 AND f$pt_wtsd<=0.15 ] ? -0.30 :
            [ f$pt_wtsd>0.15 AND f$pt_wtsd<=0.20 ] ? -0.20 :
            [ f$pt_wtsd>0.20 AND f$pt_wtsd<=0.25 ] ? -0.05 :
            [ f$pt_wtsd>0.25 AND f$pt_wtsd<=0.30 ] ?  0.05 :
            [ f$pt_wtsd>0.30 AND f$pt_wtsd<=0.40 ] ?  0.15 :
            [ f$pt_wtsd>0.40 AND f$pt_wtsd<=0.50 ] ?  0.30 :
            [ f$pt_wtsd>0.50 AND f$pt_wtsd<=0.70 ] ?  0.40 :
            [ f$pt_wtsd>0.70                       ] ?  0.50 : 0 } : 0 } :
0 } :
0

##f$Preflop_First_In##
WHEN NOT f$BettingAction_First_In RETURN false FORCE
WHEN f$Chart_OpenRaise RETURN true FORCE

##f$Preflop_Raise_After_Three_Limpers##
(f$BettingAction_Three_Limpers_Or_More AND f$Chart_RaiseMultiLimpers) ? 1 : 0

##f$Preflop_Raise_After_Two_Limpers##
(f$BettingAction_Two_Limpers AND f$Chart_TwoLimpers) ? 1 : 0

##f$Preflop_Raiser_And_Callers_In_Front_Of_Me##
(f$BettingAction_One_Raiser_And_Callers_In_Front_Of_Us AND listGeckoSqueeze) ? 1 : 0

##f$Preflop_Multiple_Raisers##
(Raises >= 2 AND listGeckoMultipleRaisers) ? 1 : 0

##f$Preflop_React_To_Reraise##
WHEN NOT IsPreflop RETURN false FORCE
WHEN NOT f$BettingAction_Hero_Did_Already_Act RETURN false FORCE
WHEN (RaisesSinceLastPlay == 1) AND listGeckoSingleRaiserBehindUs RETURN true FORCE
WHEN (RaisesSinceLastPlay >= 2) AND listGeckoMultipleRaisersBehindUs RETURN true FORCE

##f$Preflop_Raise_After_One_Limper##
(f$BettingAction_One_Limper AND f$Chart_OneLimper) ? 1 : 0

##f$Preflop_Raise_Monster##
WHEN (hand$AA OR hand$KK OR hand$QQ) RETURN true FORCE

##f$Preflop_Raiser_In_Front_Of_Me##
WHEN NOT f$BettingAction_Single_Raiser_Before_Us RETURN false FORCE
WHEN didbetsize RETURN false FORCE
WHEN (AmountToCall >= 7) RETURN false FORCE
WHEN f$Chart_ReRaise RETURN true FORCE

##f$BettingAction_Number_Of_Opponents_Truely_Playing##
(nopponentsplaying - nopponentsallin)   

##f$BettingAction_Unraised_Pot##
(ncallbets<=1)

##f$BettingAction_Raised_Pot##
NOT f$BettingAction_Unraised_Pot 

##f$BettingAction_First_In##
(f$BettingAction_Unraised_Pot AND nopponentscalling<=0)

##f$Chart_OpenRaise##
   [ InSmallBlind AND listGecko900 ] // 40%
OR [ InButton AND listGecko900 ] // 40%
OR [ InCutOff AND listGecko05  ] // 27%
OR [ InMiddlePosition3 AND listGecko02  ] // 15%
OR [ InMiddlePosition2 AND listGecko01  ] // 10%
OR [ InMiddlePosition1 AND listGecko_OpenRaise_MP1 ] // 9%
OR [ InEarlyPosition3 AND listGecko_OpenRaise_EP3  ] // 7%
OR [ InEarlyPosition2 AND listGecko_OpenRaise_EP2  ] // 6%
OR [ InEarlyPosition1 AND listGecko_OpenRaise_EP1  ] // 5%

##f$BettingAction_Hero_Did_Already_Act##
(didrais OR didcall OR didchec OR didbetsize)

##f$BettingAction_Single_Raiser_Before_Us##
((Raises == 1) AND (Calls == 0))

##f$Chart_ReRaise##
[ raischair==smallblindchair ] ? listGecko_3bet_vs_SmallBlind : 
[ raischair==dealerchair ]     ? listGecko_3bet_vs_Dealer : 
[ raischair==cutoffchair ]     ? listGecko_3bet_vs_CutOff : 
[ raischair==mp3chair ]        ? listGecko_3bet_vs_MP3 : 
[ raischair==mp2chair ]        ? listGecko_3bet_vs_MP2 : 
[ raischair==mp1chair ]        ? listGecko_3bet_vs_MP1 : 
[ raischair==ep3chair ]        ? listGecko_3bet_vs_EP3 : 
[ raischair==ep2chair ]        ? listGecko_3bet_vs_EP2 : 
[ raischair==ep1chair ]        ? listGecko_3bet_vs_EP1 :
false

##f$BettingAction_One_Raiser_And_Callers_In_Front_Of_Us##
((Raises == 1) AND (Calls >= 1))

##f$BettingAction_One_Limper##
(nopponentscalling == 1 AND ncallbets<=1)

##f$BettingAction_Two_Limpers##
(nopponentscalling == 2 AND ncallbets<=1)

##f$BettingAction_Three_Limpers_Or_More##
(nopponentscalling >= 3 AND ncallbets<=1)

##f$Chart_RaiseMultiLimpers##
listGecko01

##f$Chart_OneLimper##
   [ InSmallBlind AND listGecko06 ]  // 30%
OR [ InBigBlind AND listGecko01 ]  // 13%
OR [ InMiddlePosition2 AND listGecko01 ]  // 13%
OR [ InMiddlePosition3 AND listGecko03 ]  // 16%
OR [ InCutOff AND listGecko04 ]  // 23%
OR [ InButton AND listGecko06 ]  // 30%

##f$Chart_TwoLimpers##
   (InMiddlePosition2       AND listGecko01)
OR (InMiddlePosition3       AND listGecko01)
OR (InCutOff     AND listGecko01)
OR (InButton     AND listGecko02)
OR (InSmallBlind AND listGecko01)
OR (InBigBlind   AND listGecko01)

##f$Chart_CallRaise##
   (InSmallBlind AND listGecko09)
OR (InBigBlind   AND listGecko09)

##f$Chart_Squeeze##
// !!! Potentially incomplete FR
   [ InBigBlind   AND listGeckoSqueeze ]
OR [ InSmallBlind AND listGeckoSqueeze ]
OR [ InMiddlePosition3 AND listGeckoSqueeze ]
OR [ InButton AND (   dealpositionrais==3 AND listGeckoSqueeze
                   OR dealpositionrais==4 AND listGeckoSqueeze  
                   OR dealpositionrais==5 AND listGeckoSqueeze )] 
OR [ InCutOff AND (   dealpositionrais==3 AND listGeckoSqueeze
                   OR dealpositionrais==4 AND listGeckoSqueeze )] 
						  
##f$villain_allin##
WHEN (nopponentsplaying > 1) RETURN false FORCE
WHEN (f$stackopponent == 0) RETURN true FORCE

##f$villain_potcommitted##
WHEN (nopponentsplaying > 1) RETURN false FORCE
WHEN (f$stackopponent <= currentbet_headsupchair) RETURN true FORCE
							 

##f$actionpostflop_free_to_play##
[ call<=0 ]

##f$actionpostflop_opponent_min_bets##
[ NOT didbetsize AND (call>0) AND (call<=bblind) ]

##f$actionpostflop_opponent_bets_medium##
[ NOT didbetsize AND (call>bblind) AND (call<=(potcommon*0.8)) AND NOT f$actionpostflop_opponent_min_bets ]

##f$actionpostflop_opponent_bets_pot##
[ NOT didbetsize AND (call>(potcommon*0.8)) AND (call<=(potcommon*1.2)) AND NOT f$actionpostflop_opponent_min_bets ]

##f$actionpostflop_opponent_overbets##
[ NOT didbetsize AND (call>(potcommon*1.2)) AND NOT f$actionpostflop_opponent_min_bets ]

##f$actionpostflop_opponent_min_reraises##
[ (didbetsize OR didcall) AND currentbet<=potcommon AND call<=currentbet ]

##f$actionpostflop_opponent_reraises_normal##
[ (didbetsize OR didcall) AND (currentbet<=potcommon) AND (call>currentbet) AND (call<=(currentbet*3.5)) ]

##f$actionpostflop_opponent_reraises_huge##
[ (didbetsize OR didcall) AND (currentbet<=potcommon) AND (call>(currentbet*3.5)) ]

##f$actionpostflop_medium_investment##
[ didbetsize AND (currentbet>potcommon) AND (currentbet<=potcommon*3) ]

##f$actionpostflop_large_investment##
[ didbetsize AND (currentbet>potcommon*3) ]

##f$river_raise_wegotraised##
[ Position = First ] ? {
//  [ f$actionpostflop_free_to_play ] ? f$prwin>.76 : // let the aggressor do the betting
    [ f$actionpostflop_opponent_min_bets ] ? f$prwin>.96 :
    [ f$actionpostflop_opponent_bets_medium ] ? f$prwin>.96 :
    [ f$actionpostflop_opponent_bets_pot ] ? f$prwin>.96 :
    [ f$actionpostflop_opponent_overbets ] ? f$prwin>.96 :
    [ f$actionpostflop_opponent_min_reraises ] ? f$prwin>.96 :
    [ f$actionpostflop_opponent_reraises_normal ] ? f$prwin>.97 :
    [ f$actionpostflop_opponent_reraises_huge ] ? f$prwin>.98 :
    [ f$actionpostflop_medium_investment ] ? f$nuts      :
    [ f$actionpostflop_large_investment] ? f$nuts      : 0 } :
[ Position = Middle ] ? {
    [ f$actionpostflop_free_to_play ] ? f$prwin>.96 :
    [ f$actionpostflop_opponent_min_bets ] ? f$prwin>.90 :
    [ f$actionpostflop_opponent_bets_medium ] ? f$prwin>.96 :
    [ f$actionpostflop_opponent_bets_pot ] ? f$prwin>.96 :
    [ f$actionpostflop_opponent_overbets ] ? f$prwin>.96 :
    [ f$actionpostflop_opponent_min_reraises ] ? f$prwin>.96 :
    [ f$actionpostflop_opponent_reraises_normal ] ? f$prwin>.96 :
    [ f$actionpostflop_opponent_reraises_huge ] ? f$prwin>.97 :
    [ f$actionpostflop_medium_investment ] ? f$nuts      :
    [ f$actionpostflop_large_investment] ? f$nuts      : 0 } :
[ Position = Last ] ? {
    [ f$actionpostflop_free_to_play ] ? f$prwin>.82 :
    [ f$actionpostflop_opponent_min_bets ] ? f$prwin>.90 :
    [ f$actionpostflop_opponent_bets_medium ] ? f$prwin>.96 :
    [ f$actionpostflop_opponent_bets_pot ] ? f$prwin>.96 :
    [ f$actionpostflop_opponent_overbets ] ? f$prwin>.96 :
    [ f$actionpostflop_opponent_min_reraises ] ? f$prwin>.96 :
    [ f$actionpostflop_opponent_reraises_normal ] ? f$prwin>.96 :
    [ f$actionpostflop_opponent_reraises_huge ] ? f$prwin>.97 :
    [ f$actionpostflop_medium_investment ] ? f$nuts      :
    [ f$actionpostflop_large_investment] ? f$nuts      : 0 } :
0

##f$river_call_wegotraised##
[ Position = First ] ? {
    [ f$actionpostflop_opponent_min_bets ] ? f$prwin1>.65 :
    [ f$actionpostflop_opponent_bets_medium ] ? f$prwin1>.85 :
    [ f$actionpostflop_opponent_bets_pot ] ? f$prwin1>.90 :
    [ f$actionpostflop_opponent_overbets ] ? f$prwin1>.95 :
    [ f$actionpostflop_opponent_min_reraises ] ? f$prwin1>.95 :
    [ f$actionpostflop_opponent_reraises_normal ] ? f$prwin1>.95 :
    [ f$actionpostflop_opponent_reraises_huge ] ? f$prwin1>.95 :
    [ f$actionpostflop_medium_investment ] ? f$prwin1>.95 :
    [ f$actionpostflop_large_investment] ? f$prwin1>.98 : 0 } :
[ Position = Middle ] ? {
    [ f$actionpostflop_opponent_min_bets ] ? f$prwin1>.65 :
    [ f$actionpostflop_opponent_bets_medium ] ? f$prwin1>.90 :
    [ f$actionpostflop_opponent_bets_pot ] ? f$prwin1>.90 :
    [ f$actionpostflop_opponent_overbets ] ? f$prwin1>.95 :
    [ f$actionpostflop_opponent_min_reraises ] ? f$prwin1>.95 :
    [ f$actionpostflop_opponent_reraises_normal ] ? f$prwin1>.95 :
    [ f$actionpostflop_opponent_reraises_huge ] ? f$prwin1>.95 :
    [ f$actionpostflop_medium_investment ] ? f$prwin1>.95 :
    [ f$actionpostflop_large_investment] ? f$prwin1>.98 : 0 } :
[ Position = Last ] ? {
    [ f$actionpostflop_opponent_min_bets ] ? f$prwin1>.65 :
    [ f$actionpostflop_opponent_bets_medium ] ? f$prwin1>.90 :
    [ f$actionpostflop_opponent_bets_pot ] ? f$prwin1>.90 :
    [ f$actionpostflop_opponent_overbets ] ? f$prwin1>.95 :
    [ f$actionpostflop_opponent_min_reraises ] ? f$prwin1>.95 :
    [ f$actionpostflop_opponent_reraises_normal ] ? f$prwin1>.95 :
    [ f$actionpostflop_opponent_reraises_huge ] ? f$prwin1>.95 :
    [ f$actionpostflop_medium_investment ] ? f$prwin1>.95 :
    [ f$actionpostflop_large_investment] ? f$prwin1>.98 : 0 } :
0

##f$turn_raise_wegotraised##
[ Position = First ] ? {
    [ nplayersplaying==2 ] ? {
    [ f$actionpostflop_free_to_play ] ? f$prwin>.80 :
    [ f$actionpostflop_opponent_min_bets ] ? f$prwin>.80 :
    [ f$actionpostflop_opponent_bets_medium ] ? f$prwin>.85 :
    [ f$actionpostflop_opponent_bets_pot ] ? f$prwin>.85 :
    [ f$actionpostflop_opponent_overbets ] ? f$prwin>.95 :
    [ f$actionpostflop_opponent_min_reraises ] ? f$prwin>.96 :
    [ f$actionpostflop_opponent_reraises_normal ] ? f$prwin>.97 :
    [ f$actionpostflop_opponent_reraises_huge ] ? f$prwin>.98 :
    [ f$actionpostflop_medium_investment ] ? f$nuts      :
    [ f$actionpostflop_large_investment] ? f$nuts      : 0 } :
    [ nplayersplaying>=3 ] ? {
    [ f$actionpostflop_free_to_play ] ? f$prwin>.80 :
    [ f$actionpostflop_opponent_min_bets ] ? f$prwin>.85 :
    [ f$actionpostflop_opponent_bets_medium ] ? f$prwin>.95 :
    [ f$actionpostflop_opponent_bets_pot ] ? f$prwin>.95 :
    [ f$actionpostflop_opponent_overbets ] ? f$prwin>.95 :
    [ f$actionpostflop_opponent_min_reraises ] ? f$prwin>.96 :
    [ f$actionpostflop_opponent_reraises_normal ] ? f$prwin>.97 :
    [ f$actionpostflop_opponent_reraises_huge ] ? f$prwin>.98 :
    [ f$actionpostflop_medium_investment ] ? f$nuts      :
    [ f$actionpostflop_large_investment] ? f$nuts      : 0 } : 0 } :
[ Position = Middle ] ? {
    [ f$actionpostflop_free_to_play ] ? f$prwin>.96 :
    [ f$actionpostflop_opponent_min_bets ] ? f$prwin>.90 :
    [ f$actionpostflop_opponent_bets_medium ] ? f$prwin>.96 :
    [ f$actionpostflop_opponent_bets_pot ] ? f$prwin>.96 :
    [ f$actionpostflop_opponent_overbets ] ? f$prwin>.96 :
    [ f$actionpostflop_opponent_min_reraises ] ? f$prwin>.96 :
    [ f$actionpostflop_opponent_reraises_normal ] ? f$prwin>.96 :
    [ f$actionpostflop_opponent_reraises_huge ] ? f$prwin>.97 :
    [ f$actionpostflop_medium_investment ] ? f$nuts      :
    [ f$actionpostflop_large_investment] ? f$nuts      : 0 } :
[ Position = Last ] ? {
    [ f$actionpostflop_free_to_play ] ? f$prwin>.82 :
    [ f$actionpostflop_opponent_min_bets ] ? f$prwin>.90 :
    [ f$actionpostflop_opponent_bets_medium ] ? f$prwin>.96 :
    [ f$actionpostflop_opponent_bets_pot ] ? f$prwin>.96 :
    [ f$actionpostflop_opponent_overbets ] ? f$prwin>.96 :
    [ f$actionpostflop_opponent_min_reraises ] ? f$prwin>.96 :
    [ f$actionpostflop_opponent_reraises_normal ] ? f$prwin>.96 :
    [ f$actionpostflop_opponent_reraises_huge ] ? f$prwin>.97 :
    [ f$actionpostflop_medium_investment ] ? f$nuts      :
    [ f$actionpostflop_large_investment] ? f$nuts      : 0 } :
0

##f$turn_call_wegotraised##
[ Position = First ] ? {
    [ f$actionpostflop_opponent_min_bets ] ? f$prwin1>.60 :
    [ f$actionpostflop_opponent_bets_medium ] ? f$prwin1>.78 :
    [ f$actionpostflop_opponent_bets_pot ] ? f$prwin1>.78 :
    [ f$actionpostflop_opponent_overbets ] ? f$prwin1>.95 :
    [ f$actionpostflop_opponent_min_reraises ] ? f$prwin1>.85 :
    [ f$actionpostflop_opponent_reraises_normal ] ? f$prwin1>.90 :
    [ f$actionpostflop_opponent_reraises_huge ] ? f$prwin1>.95 :
    [ f$actionpostflop_medium_investment ] ? f$prwin1>.95 :
    [ f$actionpostflop_large_investment] ? f$prwin1>.96 : 0 } :
[ Position = Middle ] ? {
    [ f$actionpostflop_opponent_min_bets ] ? f$prwin1>.60 :
    [ f$actionpostflop_opponent_bets_medium ] ? f$prwin1>.77 :
    [ f$actionpostflop_opponent_bets_pot ] ? f$prwin1>.79 :
    [ f$actionpostflop_opponent_overbets ] ? f$prwin1>.95 :
    [ f$actionpostflop_opponent_min_reraises ] ? f$prwin1>.85 :
    [ f$actionpostflop_opponent_reraises_normal ] ? f$prwin1>.90 :
    [ f$actionpostflop_opponent_reraises_huge ] ? f$prwin1>.95 :
    [ f$actionpostflop_medium_investment ] ? f$prwin1>.95 :
    [ f$actionpostflop_large_investment] ? f$prwin1>.96 : 0 } :
[ Position = Last ] ? {
    [ f$actionpostflop_opponent_min_bets ] ? f$prwin1>.60 :
    [ f$actionpostflop_opponent_bets_medium ] ? f$prwin1>.78 :
    [ f$actionpostflop_opponent_bets_pot ] ? f$prwin1>.80 :
    [ f$actionpostflop_opponent_overbets ] ? f$prwin1>.95 :
    [ f$actionpostflop_opponent_min_reraises ] ? f$prwin1>.85 :
    [ f$actionpostflop_opponent_reraises_normal ] ? f$prwin1>.90 :
    [ f$actionpostflop_opponent_reraises_huge ] ? f$prwin1>.95 :
    [ f$actionpostflop_medium_investment ] ? f$prwin1>.95 :
    [ f$actionpostflop_large_investment] ? f$prwin1>.96 : 0 } :
0

##f$nuts##
   [ nhandshi <=0 ]
OR [ prwin > 0.97 ]

##f$villaintakeover##
[ IsTurn AND NOT didcallround_preflop AND nbetsround_preflop>1 AND NOT didbetsizeround_flop AND didcallround_flop ] ? {
    [ f$PT_Flop_AF_RaisChair<=0.00 ] ?  0.50 :
    [ pt_hands_raischair>50 ] ? {
    [ f$PT_Flop_AF_RaisChair>0.00 AND f$PT_Flop_AF_RaisChair<=0.33 ] ? 1.00 :
    [ f$PT_Flop_AF_RaisChair>0.33 AND f$PT_Flop_AF_RaisChair<=0.66 ] ? 1.00 :
    [ f$PT_Flop_AF_RaisChair>0.66 AND f$PT_Flop_AF_RaisChair<=1.00 ] ? 0.90 :
    [ f$PT_Flop_AF_RaisChair>1.00 AND f$PT_Flop_AF_RaisChair<=1.33 ] ? 0.80 :
    [ f$PT_Flop_AF_RaisChair>1.33 AND f$PT_Flop_AF_RaisChair<=1.66 ] ? 0.70 :
    [ f$PT_Flop_AF_RaisChair>1.66 AND f$PT_Flop_AF_RaisChair<=2.00 ] ? 0.60 :
    [ f$PT_Flop_AF_RaisChair>2.00 AND f$PT_Flop_AF_RaisChair<=2.50 ] ? 0.50 :
    [ f$PT_Flop_AF_RaisChair>2.50 AND f$PT_Flop_AF_RaisChair<=3.00 ] ? 0.40 :
    [ f$PT_Flop_AF_RaisChair>3.00 AND f$PT_Flop_AF_RaisChair<=4.00 ] ? 0.30 :
    [ f$PT_Flop_AF_RaisChair>4.00 AND f$PT_Flop_AF_RaisChair<=5.00 ] ? 0.20 :
    [ f$PT_Flop_AF_RaisChair>5.00                   ] ? 0.10 : 0 } : 0 } :
[ IsRiver AND NOT didcallround_preflop AND nbetsround_preflop>1 AND NOT didbetsizeround_flop AND didcallround_flop ] ? {
    [ f$PT_Flop_AF_RaisChair<=0.00 ] ? 0.50 :
    [ pt_hands_raischair>50 ] ? {
    [ f$PT_Flop_AF_RaisChair>0.00 AND f$PT_Flop_AF_RaisChair<=0.33 ] ? 1.00 :
    [ f$PT_Flop_AF_RaisChair>0.33 AND f$PT_Flop_AF_RaisChair<=0.66 ] ? 1.00 :
    [ f$PT_Flop_AF_RaisChair>0.66 AND f$PT_Flop_AF_RaisChair<=1.00 ] ? 0.90 :
    [ f$PT_Flop_AF_RaisChair>1.00 AND f$PT_Flop_AF_RaisChair<=1.33 ] ? 0.80 :
    [ f$PT_Flop_AF_RaisChair>1.33 AND f$PT_Flop_AF_RaisChair<=1.66 ] ? 0.70 :
    [ f$PT_Flop_AF_RaisChair>1.66 AND f$PT_Flop_AF_RaisChair<=2.00 ] ? 0.60 :
    [ f$PT_Flop_AF_RaisChair>2.00 AND f$PT_Flop_AF_RaisChair<=2.50 ] ? 0.50 :
    [ f$PT_Flop_AF_RaisChair>2.50 AND f$PT_Flop_AF_RaisChair<=3.00 ] ? 0.40 :
    [ f$PT_Flop_AF_RaisChair>3.00 AND f$PT_Flop_AF_RaisChair<=4.00 ] ? 0.30 :
    [ f$PT_Flop_AF_RaisChair>4.00 AND f$PT_Flop_AF_RaisChair<=5.00 ] ? 0.20 :
    [ f$PT_Flop_AF_RaisChair>5.00                                 ] ? 0.10 : 0 } : 0 } :
0

##f$reducewinchance_when_have_twopair##
[ PairOnBoard AND nplayersround_flop>2 AND istwopair AND trankcommon>7 AND NOT TwoPairOnBoard ] ? 0.4 : 0

##f$betline##
[ NOT didcallround_preflop AND nbetsround_preflop>1 AND nbetsround_preflop<=7 AND // raise preflop
  didbetsizeround_flop AND NOT didcallround_flop AND nbetsround_flop>0 AND nbetsround_flop<12 AND // cbet flop
  Position = First AND NOT didbetsize ] // early position, did not act yet

##f$prwin1##
[prwin+(prtie/2)]**(1+f$threat)

##f$prwin2##
[prwin+(prtie/2)]**(1+f$threat2)

##f$threat2##
IsFlop ? (f$foldequity+f$reducewinchance_when_have_twopair) : 0

##f$AggressionFactor_Turn2##
pt_turn_af_headsupchair * pt_wtsd_headsupchair * 4

##f$safeboard1##
[ NOT PairOnBoard AND nsuitedcommon<=2 AND nstraightcommon<=2 ]

//*****************************************************************************
//
// PokerTracker opponent modelling
//
// Gecko encoded various combinations of VPIP / PFR / WTSD / 
//   fold to contibet / raise contibet in the pqst
//   and then worked with the icon for simplicity
//   (less lookup-functions without multiplexer-engine).
//
//*****************************************************************************
// 
// POKERTRACKER AUTORATE ICONS:
//
// ptubernit1: raise flop <6% - fold to cbet <40%
// ptubernit5: raise flop <6% - fold to cbet >40% <60%
// ptubernit9: raise flop <6% - fold to cbet >60%
// 
// ptnit2: raise flop >6% raiseflop <12% - fold to cbet <40%
// ptnit6: raise flop >6% raiseflop <12% - fold to cbet >40% <60%
// ptnit10: raise flop >6% raiseflop <12% - fold to cbet >60%
// 
// pttag3: raise flop >12% raiseflop <18% - fold to cbet <40%
// pttag7: raise flop >12% raiseflop <18% - fold to cbet >40% <60%
// pttag11: raise flop >12% raiseflop <18% - fold to cbet >60%
// 
// pttag4: raise flop >18% - fold to cbet <40%
// pttag8: raise flop >18% - fold to cbet >40% <60%
// pttag12: raise flop >18%- fold to cbet >60%
//
//*****************************************************************************

##f$ptype_raise_contibet_very_low##
WHEN pt_hands_raischair < f$pt_min_hands_for_opponent_modelling RETURN false FORCE
WHEN pt_flop_raise_cbet_raischair < 0.06 RETURN true FORCE

##f$ptype_raise_contibet_low##
WHEN pt_hands_raischair < f$pt_min_hands_for_opponent_modelling RETURN false FORCE
WHEN f$ptype_raise_contibet_very_low RETURN false FORCE
WHEN pt_flop_raise_cbet_raischair < 0.12 RETURN true FORCE

##f$ptype_raise_contibet_normal##
// Too few hands counts as "normal", contrary to the other opponent types
WHEN pt_hands_raischair < f$pt_min_hands_for_opponent_modelling RETURN true FORCE
WHEN f$ptype_raise_contibet_very_low RETURN false FORCE
WHEN f$ptype_raise_contibet_low RETURN false FORCE
WHEN pt_flop_raise_cbet_raischair < 0.18 RETURN true FORCE

##f$ptype_raise_contibet_high##
WHEN pt_hands_raischair < f$pt_min_hands_for_opponent_modelling RETURN false FORCE
WHEN f$ptype_raise_contibet_very_low RETURN false FORCE
WHEN f$ptype_raise_contibet_low RETURN false FORCE
WHEN f$ptype_raise_contibet_normal RETURN false FORCE
WHEN pt_flop_raise_cbet_raischair < 0.24 RETURN true FORCE

##f$ptype_raise_contibet_very_high##
WHEN pt_hands_raischair < f$pt_min_hands_for_opponent_modelling RETURN false FORCE
WHEN pt_flop_raise_cbet_raischair >= 0.24 RETURN true FORCE

##f$fold2cbet_normal##
WHEN f$fold2cbet_high RETURN false FORCE
WHEN f$fold2cbet_low RETURN false FORCE
WHEN Others RETURN true FORCE

##f$fold2cbet_high##
WHEN pt_flop_fold_to_cbet0 > 0.60 RETURN true FORCE

##f$fold2cbet_low##
WHEN pt_flop_fold_to_cbet0 < 0.40 RETURN true FORCE

//*****************************************************************************
//
// Hand-lists for the Gecko-bot
//
//*****************************************************************************

##listGecko01##
66  77  88  99  TT  JJ  QQ  AA  KK  
ATs AJs AQs AKs KQs QJs JTs  
AJo  AQo AKo

##listGecko02##
22  33  44  55  66  77  88  99  TT  JJ  QQ  AA  KK  
A9s ATs AJs AQs AKs  
KTs KJs KQs  
QJs  
JTs  
T9s  
98s  
ATo  AJo AQo AKo 
KJo  KQo  

##listGecko03##
22  33  44  55  66  77  88  99  TT  JJ  QQ  AA  KK  
A2s A3s A4s A5s A6s A7s A8s A9s ATs AJs AQs AKs  
KJs KQs  
QTs QJs  
JTs  
T9s  
98s  
ATo  AJo AQo AKo 
KQo 

##listGecko04##
22  33  44  55  66  77  88  99  TT  JJ  QQ  AA  KK  
A5s A6s A7s A8s A9s ATs AJs AQs AKs  
K9s KTs KJs KQs  
Q9s QTs QJs  
J8s J9s JTs  
T8s T9s  
98s  
87s  
76s  
65s  
A9o  ATo AJo AQo AKo 
KTo  KJo  KQo  
QTo  QJo  
JTo 

##listGecko05##
22  33  44  55  66  77  88  99  TT  JJ  QQ  AA  KK  
A2s A3s A4s A5s A6s A7s A8s A9s ATs AJs AQs AKs  
K8s K9s KTs KJs KQs  
Q9s QTs QJs  
J8s J9s JTs  
T8s T9s  
97s 98s  
87s  
76s  
65s  
54s  
A8o  A9o ATo AJo AQo AKo 
K9o  KTo  KJo  KQo  
QTo  QJo  
JTo 

##listGecko07##
22  33  44  55  66  77  88  99  TT  JJ  QQ  AA  KK  
A2s A3s A4s A5s A6s A7s A8s A9s ATs AJs AQs AKs  
K7s K8s K9s KTs KJs KQs  
Q8s Q9s QTs QJs  
J8s J9s JTs  
T7s T8s T9s  
96s 97s 98s  
86s 87s  
75s 76s  
64s 65s  
54s  
A5o  A6o A7o A8o A9o ATo AJo AQo AKo 
K9o  KTo  KJo  KQo  
Q9o  QTo  QJo  
J9o  JTo  
T9o  

##listGecko900##
22  33  44  55  66  77  88  99  TT  JJ  QQ  AA  KK  
A2s A3s A4s A5s A6s A7s A8s A9s ATs AJs AQs AKs  
K2s K3s K4s K5s K6s K7s K8s K9s KTs KJs KQs  
Q2s Q3s Q4s Q5s Q6s Q7s Q8s Q9s QTs QJs  
J6s J7s J8s J9s JTs  
T5s T6s T7s T8s T9s  
95s 96s 97s 98s  
85s 86s 87s  
75s 76s  
64s 65s  
54s  
43s  
32s  
A2o A3o A4o A5o A6o A7o A8o A9o ATo AJo AQo AKo 
K2o K3o  K4o  K5o  K6o  K7o  K8o  K9o  KTo  KJo  KQo  
Q2o Q3o  Q4o  Q5o  Q6o  Q7o  Q8o  Q9o  QTo  QJo  
J7o  J8o  J9o  JTo
T7o  T8o  T9o  
97o 98o  
87o  
76o 

##listGeckoMultipleRaisers##
AA  KK  QQ  

##listGeckoSqueeze##
AA  KK  QQ  

##listGeckoSingleRaiserBehindUs##
AA  KK  QQ  
AKs
AKo

##listGeckoMultipleRaisersBehindUs##
AA  KK  QQ  

##listGecko06##
22  33  44  55  66  77  88  99  TT  JJ  QQ  AA  KK  
A2s A3s A4s A5s A6s A7s A8s A9s ATs AJs AQs AKs  
K7s K8s K9s KTs KJs KQs  
Q8s Q9s QTs QJs  
J8s J9s JTs  
T8s T9s  
97s 98s  
87s  
76s  
65s  
54s  
A6o  A7o A8o A9o ATo AJo AQo AKo 
K8o  K9o  KTo  KJo  KQo  
QTo  QJo  
JTo 

##listGeckoSetMining##
AA  KK  QQ  JJ  TT  99  88  77  66  55  44  33  22  
AQs AKs  
AKo  
KQs

##listGecko09##
88  99  TT  JJ  QQ  AA  KK  
AJs AQs AKs  
KQs  
AKo AQo 

##listGeckoLimpMultiway##
AA  KK  QQ  JJ  TT  99  88  77  66  55  44  33  22  
AKs KQs QJs JTs T9s 98s 87s 76s 65s  
AQs AJs ATs A9s A8s A7s A6s A5s A4s A3s A2s KJs KTs QTs J9s 
AKo AQo AJo ATo 

##listGeckoLimpAgainstOneOpponent##
AA  KK  QQ  JJ  TT  99  88  77  
AKs KQs QJs JTs T9s 98s 
AQs AJs ATs A9s A8s A7s A6s A5s A4s A3s A2s KJs KTs QTs 
AKo AQo AJo ATo 

##listGecko_3bet_vs_SmallBlind##
22  33  44  55  66  77  88  99  TT  JJ  QQ  AA  KK  
A2s A3s A4s A5s A6s A7s A8s A9s ATs AJs AQs AKs  
KJs KQs  
QTs QJs  
JTs  
T9s  
98s  
ATo  AJo AQo AKo 
KQo 

##listGecko_3bet_vs_Dealer##
22  33  44  55  66  77  88  99  TT  JJ  QQ  AA  KK  
A9s ATs AJs AQs AKs  
KTs KJs KQs  
QJs  
JTs  
T9s  
98s  
ATo  AJo AQo AKo 
KJo  KQo  

##listGecko_3bet_vs_CutOff##
AA  KK  QQ  JJ  TT  99  88  77  
AKs AQs AJs ATs  
AKo AQo AJo 
KQs

##listGecko_3bet_vs_MP3##
AA  KK  QQ  JJ  TT  99  88  
AKs AQs  
AKo

##listGecko_3bet_vs_MP2##
AA  KK  QQ  JJ  TT  99
AKs AQs 
AKo

##listGecko_3bet_vs_MP1##
AA  KK  QQ  JJ  TT  99
AKs AQs
AKo

##listGecko_3bet_vs_EP3##
AA  KK  QQ  JJ  TT
AKs 
AKo

##listGecko_3bet_vs_EP2##
AA  KK  QQ  JJ
AKs
AKo

##listGecko_3bet_vs_EP1##
AA KK QQ 
AKs
AKo

##listGecko_OpenRaise_MP1##
// Ranges for MP1, EP3 and EP2 taken from http://www.exceptionalpoker.com/?p=225
// which sounds reasonable, as MP1 is slightly tighter than Geckos MP2-range
88  99  TT  JJ  QQ  AA  KK
A9s ATs AJs AQs AKs 
KTs KJs KQs
QJs
AJo AQo AKo 

##listGecko_OpenRaise_EP3##
// Ranges for MP1, EP3 and EP2 taken from http://www.exceptionalpoker.com/?p=225
// which sounds reasonable, as MP1 is slightly tighter than Geckos MP2-range
88  99  TT  JJ  QQ  AA  KK
ATS AJS AQS AKS 
KTS KJS KQS
QJs
AQo AKo 

##listGecko_OpenRaise_EP2##
// Ranges for MP1, EP3 and EP2 taken from http://www.exceptionalpoker.com/?p=225
// which sounds reasonable, as MP1 is slightly tighter than Geckos MP2-range
88  99  TT  JJ  QQ  AA  KK
ATS AJS AQS AKS 
KJS KQS
AQo AKo 

##listGecko_OpenRaise_EP1##
// List for EP1 made up on my own ;-)
TT  JJ  QQ  AA  KK
AQS AKS 
KQS
AQo AKo
