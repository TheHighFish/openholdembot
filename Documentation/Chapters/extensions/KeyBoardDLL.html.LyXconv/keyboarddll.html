<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<meta name="generator" content="http://www.nongnu.org/elyxer/"/>
<meta name="create-date" content="2015-07-27"/>
<link rel="stylesheet" href="http://elyxer.nongnu.org/lyx.css" type="text/css" media="all"/>
<title>Converted document</title>
</head>
<body>
<div id="globalWrapper">
<h1 class="Section">
<a class="toc" name="toc-Section-1"></a><a class="IndexReference" name="entry-Keyboard-DLL-0" href="#index-Keyboard-DLL">↓</a>Keyboard <a class="IndexReference" name="entry-DLL-0" href="#index-DLL">↓</a>DLL<a class="Label" name="sec:Keyboard-DLL"> </a>
</h1>
<div class="Unindented">
The keyboard DLL extension provides for a user-specified handling of keyboard actions. The standard, reference keybaord.dll that is shipped with OpenHoldem performs very un-human-like keyboard actions. For example, there is no delay between keystrokes. When entering a betsize, a human is likely to have somewhat random delays between keypresses as the betsize amount is entered into the betsize box. Simulating keyboard actions that are more human-like may help to avoid detection by casions. 
</div>
<div class="Indented">
The keyboard DLL extension is available if you would like to implement custom keyboard action behavior. The source code for the reference keyboard.dll implementation can be found on Google Code in the source code repository.
</div>
<div class="Indented">
Two methods must be exposed in your keyboard.dll in order to interface properly with OpenHoldem. 
</div>
<div class="Indented">
“SendString” is called when OpenHoldem wants to send a string to the poker client. Generally, this method is expected to click in the specified rectangle first, to activate it. The prototype for the “SendString” method is:
</div>
<div class="Indented">
<div class="listing">
<pre class="listing">KEYBOARDDLL_API int SendString(const HWND hwnd, const RECT rect, const CString s, const bool use_comma, const HWND restore_focus, const POINT restore_cursor);
</pre>
</div>

</div>
<div class="Indented">
“SendKey” is called when OpenHoldem wants to send a single key to the poker client. Generally, this method is expected to click in the specified rectangle first, to activate it. The prototype for the “SendKey” method is:
</div>
<div class="Indented">
<div class="listing">
<pre class="listing">KEYBOARDDLL_API int SendKey(const HWND hwnd, const RECT rect, UINT vkey, const HWND restore_focus, const POINT restore_cursor);
</pre>
</div>

</div>
<div class="Indented">
<table>
<tr>
<td align="left" valign="top" style="width: 20%;">
Parameter
</td>
<td align="left" valign="top" style="width: 80%;">
Description
</td>

</tr>
<tr>
<td align="left" valign="top" style="width: 20%;">
hwnd (in)
</td>
<td align="left" valign="top" style="width: 80%;">
 the HWND of the window to take the mouse action on
</td>

</tr>
<tr>
<td align="left" valign="top" style="width: 20%;">
rect (in)
</td>
<td align="left" valign="top" style="width: 80%;">
the bounding rectangle of the area to click in to activate – this generally corresponds to a Table Map Region record rectangle, like the chat box or the betsize field; this rectangle is in relative client context; if the members of the RECT struct are {-1,-1,-1,-1} then do not click in the rectangle first 
</td>

</tr>
<tr>
<td align="left" valign="top" style="width: 20%;">
s (in)
</td>
<td align="left" valign="top" style="width: 80%;">
the string to be sent to the poker client 
</td>

</tr>
<tr>
<td align="left" valign="top" style="width: 20%;">
use_comma (in)
</td>
<td align="left" valign="top" style="width: 80%;">
if true, then use a “comma” instead of a “dot” as the decimal separator
</td>

</tr>
<tr>
<td align="left" valign="top" style="width: 20%;">
vkey (in)
</td>
<td align="left" valign="top" style="width: 80%;">
the VKEY code of the key to send to the poker client
</td>

</tr>
<tr>
<td align="left" valign="top" style="width: 20%;">
restore_focus (in)
</td>
<td align="left" valign="top" style="width: 80%;">
the HWND of the window to return focus, active and foreground to, after the action has been taken; if this is NULL, no focus resotre is requested
</td>

</tr>
<tr>
<td align="left" valign="top" style="width: 20%;">
restore_cursor (in)
</td>
<td align="left" valign="top" style="width: 80%;">
a POINT to return the cursor to, after the action has been taken; if POINT.x and POINT.y are set to -1, then no cursor return is requested
</td>

</tr>

</table>

</div>

<hr class="footer"/>
<div class="footer" id="generated-by">
Document generated by <a href="http://elyxer.nongnu.org/">eLyXer 1.2.5 (2013-03-10)</a> on <span class="create-date">2015-07-27T11:34:42.687000</span>
</div>
</div>
</body>
</html>
